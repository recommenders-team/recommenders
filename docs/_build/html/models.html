
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Recommender algorithms module &#8212; Recommenders documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'models';</script>
    <link rel="canonical" href="https://recommenders-team.github.io/recommenders/models.html" />
    <link rel="icon" href="https://raw.githubusercontent.com/recommenders-team/artwork/main/icon/recommenders_color_icon.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hyperparameter tuning module" href="tuning.html" />
    <link rel="prev" title="Evaluation module" href="evaluation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="https://raw.githubusercontent.com/recommenders-team/artwork/main/color/recommenders_color.svg" class="logo__image only-light" alt="Recommenders documentation - Home"/>
    <script>document.write(`<img src="https://raw.githubusercontent.com/recommenders-team/artwork/main/color/recommenders_color.svg" class="logo__image only-dark" alt="Recommenders documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Recommenders API Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Dataset module</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation.html">Evaluation module</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Recommender algorithms module</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning.html">Hyperparameter tuning module</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Common utilities module</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/recommenders-team/recommenders" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/recommenders-team/recommenders/issues/new?title=Issue%20on%20page%20%2Fmodels.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/models.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Recommender algorithms module</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.cornac.cornac_utils">Cornac utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.cornac_utils.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.cornac_utils.predict_ranking"><code class="docutils literal notranslate"><span class="pre">predict_ranking()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.bpr.BPR"><code class="docutils literal notranslate"><span class="pre">BPR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.bpr.BPR.__init__"><code class="docutils literal notranslate"><span class="pre">BPR.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.bpr.BPR.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">BPR.recommend_k_items()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deeprec-utilities">DeepRec utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.base_model">Base model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.__init__"><code class="docutils literal notranslate"><span class="pre">BaseModel.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.eval"><code class="docutils literal notranslate"><span class="pre">BaseModel.eval()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.fit"><code class="docutils literal notranslate"><span class="pre">BaseModel.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.group_labels"><code class="docutils literal notranslate"><span class="pre">BaseModel.group_labels()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.infer"><code class="docutils literal notranslate"><span class="pre">BaseModel.infer()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.load_model"><code class="docutils literal notranslate"><span class="pre">BaseModel.load_model()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.predict"><code class="docutils literal notranslate"><span class="pre">BaseModel.predict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.run_eval"><code class="docutils literal notranslate"><span class="pre">BaseModel.run_eval()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.train"><code class="docutils literal notranslate"><span class="pre">BaseModel.train()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.sequential_base_model">Sequential base model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.__init__"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.fit"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.predict"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel.predict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.run_eval"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel.run_eval()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.io.iterator">Iterators</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.BaseIterator"><code class="docutils literal notranslate"><span class="pre">BaseIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.BaseIterator.gen_feed_dict"><code class="docutils literal notranslate"><span class="pre">BaseIterator.gen_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.BaseIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">BaseIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.BaseIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">BaseIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.__init__"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.gen_feed_dict"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator.gen_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.__init__"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_feed_dict"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.gen_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_infer_feed_dict"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.gen_infer_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_infer_data_from_file"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.load_infer_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator"><code class="docutils literal notranslate"><span class="pre">DKNItem2itemTextIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.__init__"><code class="docutils literal notranslate"><span class="pre">DKNItem2itemTextIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">DKNItem2itemTextIterator.load_data_from_file()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator"><code class="docutils literal notranslate"><span class="pre">NextItNetIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator.__init__"><code class="docutils literal notranslate"><span class="pre">NextItNetIterator.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator"><code class="docutils literal notranslate"><span class="pre">SequentialIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.__init__"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.gen_feed_dict"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.gen_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parse_file"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.parse_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.DataModel.ImplicitCF">Data processing utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF"><code class="docutils literal notranslate"><span class="pre">ImplicitCF</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.__init__"><code class="docutils literal notranslate"><span class="pre">ImplicitCF.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.create_norm_adj_mat"><code class="docutils literal notranslate"><span class="pre">ImplicitCF.create_norm_adj_mat()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.get_norm_adj_mat"><code class="docutils literal notranslate"><span class="pre">ImplicitCF.get_norm_adj_mat()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.train_loader"><code class="docutils literal notranslate"><span class="pre">ImplicitCF.train_loader()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.deeprec_utils">Utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.HParams"><code class="docutils literal notranslate"><span class="pre">HParams</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.HParams.__init__"><code class="docutils literal notranslate"><span class="pre">HParams.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.HParams.__repr__"><code class="docutils literal notranslate"><span class="pre">HParams.__repr__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.HParams.values"><code class="docutils literal notranslate"><span class="pre">HParams.values()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.cal_metric"><code class="docutils literal notranslate"><span class="pre">cal_metric()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.check_nn_config"><code class="docutils literal notranslate"><span class="pre">check_nn_config()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.check_type"><code class="docutils literal notranslate"><span class="pre">check_type()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.create_hparams"><code class="docutils literal notranslate"><span class="pre">create_hparams()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.dcg_score"><code class="docutils literal notranslate"><span class="pre">dcg_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.download_deeprec_resources"><code class="docutils literal notranslate"><span class="pre">download_deeprec_resources()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.flat_config"><code class="docutils literal notranslate"><span class="pre">flat_config()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.hit_score"><code class="docutils literal notranslate"><span class="pre">hit_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.load_dict"><code class="docutils literal notranslate"><span class="pre">load_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.load_yaml"><code class="docutils literal notranslate"><span class="pre">load_yaml()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.mrr_score"><code class="docutils literal notranslate"><span class="pre">mrr_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.ndcg_score"><code class="docutils literal notranslate"><span class="pre">ndcg_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.prepare_hparams"><code class="docutils literal notranslate"><span class="pre">prepare_hparams()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.dkn">DKN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn.DKN"><code class="docutils literal notranslate"><span class="pre">DKN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn.DKN.__init__"><code class="docutils literal notranslate"><span class="pre">DKN.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn.DKN.infer_embedding"><code class="docutils literal notranslate"><span class="pre">DKN.infer_embedding()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn.DKN.run_get_embedding"><code class="docutils literal notranslate"><span class="pre">DKN.run_get_embedding()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.dkn_item2item">DKN item-to-item</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item"><code class="docutils literal notranslate"><span class="pre">DKNItem2Item</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.eval"><code class="docutils literal notranslate"><span class="pre">DKNItem2Item.eval()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.run_eval"><code class="docutils literal notranslate"><span class="pre">DKNItem2Item.run_eval()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.xDeepFM">xDeepFM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.xDeepFM.XDeepFMModel"><code class="docutils literal notranslate"><span class="pre">XDeepFMModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.graphrec.lightgcn">LightGCN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN"><code class="docutils literal notranslate"><span class="pre">LightGCN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.__init__"><code class="docutils literal notranslate"><span class="pre">LightGCN.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.fit"><code class="docutils literal notranslate"><span class="pre">LightGCN.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.infer_embedding"><code class="docutils literal notranslate"><span class="pre">LightGCN.infer_embedding()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.load"><code class="docutils literal notranslate"><span class="pre">LightGCN.load()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">LightGCN.recommend_k_items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.run_eval"><code class="docutils literal notranslate"><span class="pre">LightGCN.run_eval()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.score"><code class="docutils literal notranslate"><span class="pre">LightGCN.score()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.asvd">A2SVD</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.asvd.A2SVDModel"><code class="docutils literal notranslate"><span class="pre">A2SVDModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.caser">Caser</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.caser.CaserModel"><code class="docutils literal notranslate"><span class="pre">CaserModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.caser.CaserModel.__init__"><code class="docutils literal notranslate"><span class="pre">CaserModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gru">GRU</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.nextitnet">NextItNet</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.nextitnet.NextItNetModel"><code class="docutils literal notranslate"><span class="pre">NextItNetModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.rnn_cell_implement">RNN Cells</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell"><code class="docutils literal notranslate"><span class="pre">Time4ALSTMCell</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.call"><code class="docutils literal notranslate"><span class="pre">Time4ALSTMCell.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.output_size"><code class="docutils literal notranslate"><span class="pre">Time4ALSTMCell.output_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.state_size"><code class="docutils literal notranslate"><span class="pre">Time4ALSTMCell.state_size</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell"><code class="docutils literal notranslate"><span class="pre">Time4LSTMCell</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.call"><code class="docutils literal notranslate"><span class="pre">Time4LSTMCell.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.output_size"><code class="docutils literal notranslate"><span class="pre">Time4LSTMCell.output_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.state_size"><code class="docutils literal notranslate"><span class="pre">Time4LSTMCell.state_size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">SUM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.sli_rec">SLIRec</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sli_rec.SLI_RECModel"><code class="docutils literal notranslate"><span class="pre">SLI_RECModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#embdotbias-utilities">EmbDotBias utilities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.lightfm.lightfm_utils">LightFM utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.compare_metric"><code class="docutils literal notranslate"><span class="pre">compare_metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.model_perf_plots"><code class="docutils literal notranslate"><span class="pre">model_perf_plots()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.prepare_all_predictions"><code class="docutils literal notranslate"><span class="pre">prepare_all_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.prepare_test_df"><code class="docutils literal notranslate"><span class="pre">prepare_test_df()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.similar_items"><code class="docutils literal notranslate"><span class="pre">similar_items()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.similar_users"><code class="docutils literal notranslate"><span class="pre">similar_users()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.track_model_metrics"><code class="docutils literal notranslate"><span class="pre">track_model_metrics()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.lightgbm.lightgbm_utils">LightGBM utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder"><code class="docutils literal notranslate"><span class="pre">NumEncoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.fit_transform"><code class="docutils literal notranslate"><span class="pre">NumEncoder.fit_transform()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.transform"><code class="docutils literal notranslate"><span class="pre">NumEncoder.transform()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightgbm.lightgbm_utils.unpackbits"><code class="docutils literal notranslate"><span class="pre">unpackbits()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.ncf.dataset">NCF</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.DataFile"><code class="docutils literal notranslate"><span class="pre">DataFile</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.DataFile.__init__"><code class="docutils literal notranslate"><span class="pre">DataFile.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.DataFile.load_data"><code class="docutils literal notranslate"><span class="pre">DataFile.load_data()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.Dataset"><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.Dataset.__init__"><code class="docutils literal notranslate"><span class="pre">Dataset.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.Dataset.test_loader"><code class="docutils literal notranslate"><span class="pre">Dataset.test_loader()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.Dataset.train_loader"><code class="docutils literal notranslate"><span class="pre">Dataset.train_loader()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.EmptyFileException"><code class="docutils literal notranslate"><span class="pre">EmptyFileException</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.FileNotSortedException"><code class="docutils literal notranslate"><span class="pre">FileNotSortedException</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.MissingFieldsException"><code class="docutils literal notranslate"><span class="pre">MissingFieldsException</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.MissingUserException"><code class="docutils literal notranslate"><span class="pre">MissingUserException</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.NegativeSampler"><code class="docutils literal notranslate"><span class="pre">NegativeSampler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.NegativeSampler.__init__"><code class="docutils literal notranslate"><span class="pre">NegativeSampler.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.NegativeSampler.sample"><code class="docutils literal notranslate"><span class="pre">NegativeSampler.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF"><code class="docutils literal notranslate"><span class="pre">NCF</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.__init__"><code class="docutils literal notranslate"><span class="pre">NCF.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.fit"><code class="docutils literal notranslate"><span class="pre">NCF.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.load"><code class="docutils literal notranslate"><span class="pre">NCF.load()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.predict"><code class="docutils literal notranslate"><span class="pre">NCF.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.save"><code class="docutils literal notranslate"><span class="pre">NCF.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newsrec-utilities">NewsRec utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Base model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.hparams"><code class="docutils literal notranslate"><span class="pre">BaseModel.hparams</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.train_iterator"><code class="docutils literal notranslate"><span class="pre">BaseModel.train_iterator</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.test_iterator"><code class="docutils literal notranslate"><span class="pre">BaseModel.test_iterator</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.graph"><code class="docutils literal notranslate"><span class="pre">BaseModel.graph</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.seed"><code class="docutils literal notranslate"><span class="pre">BaseModel.seed</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.__init__"><code class="docutils literal notranslate"><span class="pre">BaseModel.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.eval"><code class="docutils literal notranslate"><span class="pre">BaseModel.eval()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.fit"><code class="docutils literal notranslate"><span class="pre">BaseModel.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.group_labels"><code class="docutils literal notranslate"><span class="pre">BaseModel.group_labels()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.run_eval"><code class="docutils literal notranslate"><span class="pre">BaseModel.run_eval()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.train"><code class="docutils literal notranslate"><span class="pre">BaseModel.train()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Iterators</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator"><code class="docutils literal notranslate"><span class="pre">MINDIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.col_spliter"><code class="docutils literal notranslate"><span class="pre">MINDIterator.col_spliter</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.ID_spliter"><code class="docutils literal notranslate"><span class="pre">MINDIterator.ID_spliter</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.batch_size"><code class="docutils literal notranslate"><span class="pre">MINDIterator.batch_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.title_size"><code class="docutils literal notranslate"><span class="pre">MINDIterator.title_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.his_size"><code class="docutils literal notranslate"><span class="pre">MINDIterator.his_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.npratio"><code class="docutils literal notranslate"><span class="pre">MINDIterator.npratio</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.__init__"><code class="docutils literal notranslate"><span class="pre">MINDIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_behaviors"><code class="docutils literal notranslate"><span class="pre">MINDIterator.init_behaviors()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_news"><code class="docutils literal notranslate"><span class="pre">MINDIterator.init_news()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_dict"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_impression_from_file"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_impression_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_news_from_file"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_news_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_user_from_file"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_user_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">MINDIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.col_spliter"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.col_spliter</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.ID_spliter"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.ID_spliter</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.batch_size"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.batch_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.title_size"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.title_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.body_size"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.body_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.his_size"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.his_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.npratio"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.npratio</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.__init__"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_behaviors"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.init_behaviors()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_news"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.init_news()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_dict"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_impression_from_file"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_impression_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_news_from_file"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_news_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_user_from_file"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_user_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2"><code class="docutils literal notranslate"><span class="pre">AttLayer2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.dim"><code class="docutils literal notranslate"><span class="pre">AttLayer2.dim</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.__init__"><code class="docutils literal notranslate"><span class="pre">AttLayer2.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.build"><code class="docutils literal notranslate"><span class="pre">AttLayer2.build()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.call"><code class="docutils literal notranslate"><span class="pre">AttLayer2.call()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.compute_mask"><code class="docutils literal notranslate"><span class="pre">AttLayer2.compute_mask()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">AttLayer2.compute_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.ComputeMasking"><code class="docutils literal notranslate"><span class="pre">ComputeMasking</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.ComputeMasking.call"><code class="docutils literal notranslate"><span class="pre">ComputeMasking.call()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.ComputeMasking.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">ComputeMasking.compute_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.OverwriteMasking"><code class="docutils literal notranslate"><span class="pre">OverwriteMasking</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.build"><code class="docutils literal notranslate"><span class="pre">OverwriteMasking.build()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.call"><code class="docutils literal notranslate"><span class="pre">OverwriteMasking.call()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">OverwriteMasking.compute_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.PersonalizedAttentivePooling"><code class="docutils literal notranslate"><span class="pre">PersonalizedAttentivePooling()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.dim1"><code class="docutils literal notranslate"><span class="pre">dim1</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.dim2"><code class="docutils literal notranslate"><span class="pre">dim2</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.dim3"><code class="docutils literal notranslate"><span class="pre">dim3</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention"><code class="docutils literal notranslate"><span class="pre">SelfAttention</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.Mask"><code class="docutils literal notranslate"><span class="pre">SelfAttention.Mask()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.__init__"><code class="docutils literal notranslate"><span class="pre">SelfAttention.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.build"><code class="docutils literal notranslate"><span class="pre">SelfAttention.build()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.call"><code class="docutils literal notranslate"><span class="pre">SelfAttention.call()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">SelfAttention.compute_output_shape()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.get_config"><code class="docutils literal notranslate"><span class="pre">SelfAttention.get_config()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.check_nn_config"><code class="docutils literal notranslate"><span class="pre">check_nn_config()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.check_type"><code class="docutils literal notranslate"><span class="pre">check_type()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.create_hparams"><code class="docutils literal notranslate"><span class="pre">create_hparams()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.get_mind_data_set"><code class="docutils literal notranslate"><span class="pre">get_mind_data_set()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.newsample"><code class="docutils literal notranslate"><span class="pre">newsample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.prepare_hparams"><code class="docutils literal notranslate"><span class="pre">prepare_hparams()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.word_tokenize"><code class="docutils literal notranslate"><span class="pre">word_tokenize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.models.lstur">LSTUR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.lstur.LSTURModel"><code class="docutils literal notranslate"><span class="pre">LSTURModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.lstur.LSTURModel.word2vec_embedding"><code class="docutils literal notranslate"><span class="pre">LSTURModel.word2vec_embedding</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.lstur.LSTURModel.hparam"><code class="docutils literal notranslate"><span class="pre">LSTURModel.hparam</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.lstur.LSTURModel.__init__"><code class="docutils literal notranslate"><span class="pre">LSTURModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.models.naml">NAML</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.naml.NAMLModel"><code class="docutils literal notranslate"><span class="pre">NAMLModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.naml.NAMLModel.word2vec_embedding"><code class="docutils literal notranslate"><span class="pre">NAMLModel.word2vec_embedding</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.naml.NAMLModel.hparam"><code class="docutils literal notranslate"><span class="pre">NAMLModel.hparam</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.naml.NAMLModel.__init__"><code class="docutils literal notranslate"><span class="pre">NAMLModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.models.npa">NPA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.npa.NPAModel"><code class="docutils literal notranslate"><span class="pre">NPAModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.npa.NPAModel.word2vec_embedding"><code class="docutils literal notranslate"><span class="pre">NPAModel.word2vec_embedding</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.npa.NPAModel.hparam"><code class="docutils literal notranslate"><span class="pre">NPAModel.hparam</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.npa.NPAModel.__init__"><code class="docutils literal notranslate"><span class="pre">NPAModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.models.nrms">NRMS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.nrms.NRMSModel"><code class="docutils literal notranslate"><span class="pre">NRMSModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.nrms.NRMSModel.word2vec_embedding"><code class="docutils literal notranslate"><span class="pre">NRMSModel.word2vec_embedding</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.nrms.NRMSModel.hparam"><code class="docutils literal notranslate"><span class="pre">NRMSModel.hparam</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.nrms.NRMSModel.__init__"><code class="docutils literal notranslate"><span class="pre">NRMSModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.rbm.rbm">RBM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM"><code class="docutils literal notranslate"><span class="pre">RBM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.__init__"><code class="docutils literal notranslate"><span class="pre">RBM.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.batch_training"><code class="docutils literal notranslate"><span class="pre">RBM.batch_training()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.binomial_sampling"><code class="docutils literal notranslate"><span class="pre">RBM.binomial_sampling()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.data_pipeline"><code class="docutils literal notranslate"><span class="pre">RBM.data_pipeline()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.eval_out"><code class="docutils literal notranslate"><span class="pre">RBM.eval_out()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.fit"><code class="docutils literal notranslate"><span class="pre">RBM.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.free_energy"><code class="docutils literal notranslate"><span class="pre">RBM.free_energy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.generate_graph"><code class="docutils literal notranslate"><span class="pre">RBM.generate_graph()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.gibbs_protocol"><code class="docutils literal notranslate"><span class="pre">RBM.gibbs_protocol()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.gibbs_sampling"><code class="docutils literal notranslate"><span class="pre">RBM.gibbs_sampling()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.init_gpu"><code class="docutils literal notranslate"><span class="pre">RBM.init_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.init_metrics"><code class="docutils literal notranslate"><span class="pre">RBM.init_metrics()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.init_parameters"><code class="docutils literal notranslate"><span class="pre">RBM.init_parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.init_training_session"><code class="docutils literal notranslate"><span class="pre">RBM.init_training_session()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.load"><code class="docutils literal notranslate"><span class="pre">RBM.load()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.losses"><code class="docutils literal notranslate"><span class="pre">RBM.losses()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.multinomial_distribution"><code class="docutils literal notranslate"><span class="pre">RBM.multinomial_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.multinomial_sampling"><code class="docutils literal notranslate"><span class="pre">RBM.multinomial_sampling()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.placeholder"><code class="docutils literal notranslate"><span class="pre">RBM.placeholder()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.predict"><code class="docutils literal notranslate"><span class="pre">RBM.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">RBM.recommend_k_items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.sample_hidden_units"><code class="docutils literal notranslate"><span class="pre">RBM.sample_hidden_units()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.sample_visible_units"><code class="docutils literal notranslate"><span class="pre">RBM.sample_visible_units()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.save"><code class="docutils literal notranslate"><span class="pre">RBM.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sar.sar_singlenode">SAR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode"><code class="docutils literal notranslate"><span class="pre">SARSingleNode</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.__init__"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_affinity_matrix"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.compute_affinity_matrix()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_cooccurrence_matrix"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.compute_cooccurrence_matrix()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_time_decay"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.compute_time_decay()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.fit"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_item_based_topk"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.get_item_based_topk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_popularity_based_topk"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.get_popularity_based_topk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_topk_most_similar_users"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.get_topk_most_similar_users()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.predict"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.recommend_k_items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.score"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.set_index"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.set_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sasrec.model">SASRec</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.Encoder"><code class="docutils literal notranslate"><span class="pre">Encoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.Encoder.__init__"><code class="docutils literal notranslate"><span class="pre">Encoder.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.Encoder.call"><code class="docutils literal notranslate"><span class="pre">Encoder.call()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.EncoderLayer"><code class="docutils literal notranslate"><span class="pre">EncoderLayer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.EncoderLayer.__init__"><code class="docutils literal notranslate"><span class="pre">EncoderLayer.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.EncoderLayer.call"><code class="docutils literal notranslate"><span class="pre">EncoderLayer.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.EncoderLayer.call_"><code class="docutils literal notranslate"><span class="pre">EncoderLayer.call_()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.LayerNormalization"><code class="docutils literal notranslate"><span class="pre">LayerNormalization</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.LayerNormalization.__init__"><code class="docutils literal notranslate"><span class="pre">LayerNormalization.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.LayerNormalization.call"><code class="docutils literal notranslate"><span class="pre">LayerNormalization.call()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.MultiHeadAttention"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.MultiHeadAttention.__init__"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.MultiHeadAttention.call"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention.call()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.PointWiseFeedForward"><code class="docutils literal notranslate"><span class="pre">PointWiseFeedForward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.PointWiseFeedForward.__init__"><code class="docutils literal notranslate"><span class="pre">PointWiseFeedForward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.PointWiseFeedForward.call"><code class="docutils literal notranslate"><span class="pre">PointWiseFeedForward.call()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC"><code class="docutils literal notranslate"><span class="pre">SASREC</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.__init__"><code class="docutils literal notranslate"><span class="pre">SASREC.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.call"><code class="docutils literal notranslate"><span class="pre">SASREC.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.create_combined_dataset"><code class="docutils literal notranslate"><span class="pre">SASREC.create_combined_dataset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.embedding"><code class="docutils literal notranslate"><span class="pre">SASREC.embedding()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.evaluate"><code class="docutils literal notranslate"><span class="pre">SASREC.evaluate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.evaluate_valid"><code class="docutils literal notranslate"><span class="pre">SASREC.evaluate_valid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.loss_function"><code class="docutils literal notranslate"><span class="pre">SASREC.loss_function()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.predict"><code class="docutils literal notranslate"><span class="pre">SASREC.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.train"><code class="docutils literal notranslate"><span class="pre">SASREC.train()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler"><code class="docutils literal notranslate"><span class="pre">WarpSampler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.User"><code class="docutils literal notranslate"><span class="pre">WarpSampler.User</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.usernum"><code class="docutils literal notranslate"><span class="pre">WarpSampler.usernum</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.itemnum"><code class="docutils literal notranslate"><span class="pre">WarpSampler.itemnum</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.batch_size"><code class="docutils literal notranslate"><span class="pre">WarpSampler.batch_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.maxlen"><code class="docutils literal notranslate"><span class="pre">WarpSampler.maxlen</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.n_workers"><code class="docutils literal notranslate"><span class="pre">WarpSampler.n_workers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.__init__"><code class="docutils literal notranslate"><span class="pre">WarpSampler.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.sample_function"><code class="docutils literal notranslate"><span class="pre">sample_function()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.usernum"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.usernum</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.itemnum"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.itemnum</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.User"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.User</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.Items"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.Items</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.user_train"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.user_train</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.user_valid"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.user_valid</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.user_test"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.user_test</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.col_sep"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.col_sep</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.filename"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.filename</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sasrec.ssept">SSE-PT</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT"><code class="docutils literal notranslate"><span class="pre">SSEPT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT.__init__"><code class="docutils literal notranslate"><span class="pre">SSEPT.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT.call"><code class="docutils literal notranslate"><span class="pre">SSEPT.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT.loss_function"><code class="docutils literal notranslate"><span class="pre">SSEPT.loss_function()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT.predict"><code class="docutils literal notranslate"><span class="pre">SSEPT.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.surprise.surprise_utils">Surprise utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.surprise.surprise_utils.compute_ranking_predictions"><code class="docutils literal notranslate"><span class="pre">compute_ranking_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.surprise.surprise_utils.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.surprise.surprise_utils.surprise_trainset_to_df"><code class="docutils literal notranslate"><span class="pre">surprise_trainset_to_df()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.tfidf.tfidf_utils">TF-IDF utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.clean_dataframe"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.clean_dataframe()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.fit"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_stop_words"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.get_stop_words()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_tokens"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.get_tokens()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_top_k_recommendations"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.get_top_k_recommendations()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.recommend_top_k_items"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.recommend_top_k_items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.tokenize_text"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.tokenize_text()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.vae.standard_vae">Standard VAE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.__init__"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.get_data"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.get_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_batch_end"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_train_begin"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.LossHistory"><code class="docutils literal notranslate"><span class="pre">LossHistory</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.LossHistory.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">LossHistory.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.LossHistory.on_train_begin"><code class="docutils literal notranslate"><span class="pre">LossHistory.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics"><code class="docutils literal notranslate"><span class="pre">Metrics</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.__init__"><code class="docutils literal notranslate"><span class="pre">Metrics.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.get_data"><code class="docutils literal notranslate"><span class="pre">Metrics.get_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">Metrics.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.on_train_begin"><code class="docutils literal notranslate"><span class="pre">Metrics.on_train_begin()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">Metrics.recommend_k_items()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE"><code class="docutils literal notranslate"><span class="pre">StandardVAE</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.__init__"><code class="docutils literal notranslate"><span class="pre">StandardVAE.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.display_metrics"><code class="docutils literal notranslate"><span class="pre">StandardVAE.display_metrics()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.fit"><code class="docutils literal notranslate"><span class="pre">StandardVAE.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.get_optimal_beta"><code class="docutils literal notranslate"><span class="pre">StandardVAE.get_optimal_beta()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.ndcg_per_epoch"><code class="docutils literal notranslate"><span class="pre">StandardVAE.ndcg_per_epoch()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.nn_batch_generator"><code class="docutils literal notranslate"><span class="pre">StandardVAE.nn_batch_generator()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">StandardVAE.recommend_k_items()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.vae.multinomial_vae">Multinomial VAE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.__init__"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.get_data"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.get_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_batch_end"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_train_begin"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.LossHistory"><code class="docutils literal notranslate"><span class="pre">LossHistory</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.LossHistory.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">LossHistory.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.LossHistory.on_train_begin"><code class="docutils literal notranslate"><span class="pre">LossHistory.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics"><code class="docutils literal notranslate"><span class="pre">Metrics</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.__init__"><code class="docutils literal notranslate"><span class="pre">Metrics.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.get_data"><code class="docutils literal notranslate"><span class="pre">Metrics.get_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">Metrics.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.on_train_begin"><code class="docutils literal notranslate"><span class="pre">Metrics.on_train_begin()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">Metrics.recommend_k_items()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE"><code class="docutils literal notranslate"><span class="pre">Mult_VAE</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.__init__"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.display_metrics"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.display_metrics()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.fit"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.get_optimal_beta"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.get_optimal_beta()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.ndcg_per_epoch"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.ndcg_per_epoch()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.nn_batch_generator"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.nn_batch_generator()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.recommend_k_items()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.vowpal_wabbit.vw">Vowpal Wabbit utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW"><code class="docutils literal notranslate"><span class="pre">VW</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.fit"><code class="docutils literal notranslate"><span class="pre">VW.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.parse_test_params"><code class="docutils literal notranslate"><span class="pre">VW.parse_test_params()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.parse_train_params"><code class="docutils literal notranslate"><span class="pre">VW.parse_train_params()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.predict"><code class="docutils literal notranslate"><span class="pre">VW.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.to_vw_cmd"><code class="docutils literal notranslate"><span class="pre">VW.to_vw_cmd()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.to_vw_file"><code class="docutils literal notranslate"><span class="pre">VW.to_vw_file()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.wide_deep.wide_deep_utils">Wide &amp; Deep</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.wide_deep.wide_deep_utils.build_feature_columns"><code class="docutils literal notranslate"><span class="pre">build_feature_columns()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.wide_deep.wide_deep_utils.build_model"><code class="docutils literal notranslate"><span class="pre">build_model()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="recommender-algorithms-module">
<span id="recommender"></span><h1>Recommender algorithms module<a class="headerlink" href="#recommender-algorithms-module" title="Link to this heading">#</a></h1>
<p>Recommender system algorithms and utilities.</p>
<section id="module-recommenders.models.cornac.cornac_utils">
<span id="cornac-utilities"></span><h2>Cornac utilities<a class="headerlink" href="#module-recommenders.models.cornac.cornac_utils" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.cornac.cornac_utils.predict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.cornac.cornac_utils.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/cornac/cornac_utils.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.cornac_utils.predict" title="Link to this definition">#</a></dt>
<dd><p>Computes predictions of a recommender model from Cornac on the data.
Can be used for computing rating metrics like RMSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>cornac.models.Recommender</em>) – A recommender model from Cornac</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – The data on which to predict</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – Name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – Name of the item column</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.cornac.cornac_utils.predict_ranking">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.cornac.cornac_utils.</span></span><span class="sig-name descname"><span class="pre">predict_ranking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/cornac/cornac_utils.html#predict_ranking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.cornac_utils.predict_ranking" title="Link to this definition">#</a></dt>
<dd><p>Computes predictions of recommender model from Cornac on all users and items in data.
It can be used for computing ranking metrics like NDCG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>cornac.models.Recommender</em>) – A recommender model from Cornac</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – The data from which to get the users and items</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – Name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – Name of the item column</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – Flag to remove (user, item) pairs seen in the training data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-recommenders.models.cornac.bpr">
<dt class="sig sig-object py" id="recommenders.models.cornac.bpr.BPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.cornac.bpr.</span></span><span class="sig-name descname"><span class="pre">BPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/cornac/bpr.html#BPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.bpr.BPR" title="Link to this definition">#</a></dt>
<dd><p>Custom BPR class extending Cornac’s BPR model with a recommend_k_items method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.cornac.bpr.BPR.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/cornac/bpr.html#BPR.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.bpr.BPR.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.cornac.bpr.BPR.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/cornac/bpr.html#BPR.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.bpr.BPR.recommend_k_items" title="Link to this definition">#</a></dt>
<dd><p>Computes top-k predictions of recommender model from Cornac on all users in data.
It can be used for computing ranking metrics like NDCG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – The data from which to get the users and items.</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – Number of items to recommend per user.</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – Flag to remove (user, item) pairs seen in the training data.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – Name of the user column.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Name of the item column.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Name of the prediction column.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with col_user, col_item, col_rating for top-k items per user.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="deeprec-utilities">
<h2>DeepRec utilities<a class="headerlink" href="#deeprec-utilities" title="Link to this heading">#</a></h2>
<section id="module-recommenders.models.deeprec.models.base_model">
<span id="base-model"></span><h3>Base model<a class="headerlink" href="#module-recommenders.models.deeprec.models.base_model" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.base_model.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel" title="Link to this definition">#</a></dt>
<dd><p>Base class for models</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializing the model. Create common logics which are needed by all deeprec models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – An <cite>HParams</cite> object, holds the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.eval" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the data in <cite>feed_dict</cite> with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values for evaluation. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of evaluated results, including total loss value, data loss value, predicted scores, and ground-truth labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit the model with <cite>train_file</cite>. Evaluate the model on valid_file per epoch to observe the training status.
If <cite>test_file</cite> is not None, evaluate it too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>str</em>) – training data set.</p></li>
<li><p><strong>valid_file</strong> (<em>str</em>) – validation set.</p></li>
<li><p><strong>test_file</strong> (<em>str</em>) – test set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.group_labels">
<span class="sig-name descname"><span class="pre">group_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.group_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.group_labels" title="Link to this definition">#</a></dt>
<dd><p>Devide <cite>labels</cite> and <cite>preds</cite> into several group according to values in group keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list</em>) – ground truth label list.</p></li>
<li><p><strong>preds</strong> (<em>list</em>) – prediction score list.</p></li>
<li><p><strong>group_keys</strong> (<em>list</em>) – group key list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Labels after group.</p></li>
<li><p>Predictions after group.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.infer">
<span class="sig-name descname"><span class="pre">infer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.infer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.infer" title="Link to this definition">#</a></dt>
<dd><p>Given feature data (in <cite>feed_dict</cite>), get predicted scores with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Instances to predict. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted scores for the given instances.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.load_model" title="Link to this definition">#</a></dt>
<dd><p>Load an existing model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_path</strong> – model path.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>IOError</strong> – if the restore operation failed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.predict" title="Link to this definition">#</a></dt>
<dd><p>Make predictions on the given data, and output predicted scores to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile_name</strong> (<em>str</em>) – Input file name, format is same as train/val/test file.</p></li>
<li><p><strong>outfile_name</strong> (<em>str</em>) – Output file name, each line is the predict score.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.run_eval" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the given file and returns some evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – A file name that will be evaluated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that contains evaluation metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.train" title="Link to this definition">#</a></dt>
<dd><p>Go through the optimization step once with training data in <cite>feed_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values to train the model. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of values, including update operation, total loss, data loss, and merged summary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.models.sequential.sequential_base_model">
<span id="sequential-base-model"></span><h3>Sequential base model<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.sequential_base_model" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.sequential_base_model.</span></span><span class="sig-name descname"><span class="pre">SequentialBaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel" title="Link to this definition">#</a></dt>
<dd><p>Base class for sequential models</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializing the model. Create common logics which are needed by all sequential models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams"><em>HParams</em></a>) – A <cite>HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_num_ngs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'group_auc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit the model with <cite>train_file</cite>. Evaluate the model on <cite>valid_file</cite> per epoch to observe the training status.
If <cite>test_file</cite> is not None, evaluate it too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>str</em>) – training data set.</p></li>
<li><p><strong>valid_file</strong> (<em>str</em>) – validation set.</p></li>
<li><p><strong>valid_num_ngs</strong> (<em>int</em>) – the number of negative instances with one positive instance in validation data.</p></li>
<li><p><strong>eval_metric</strong> (<em>str</em>) – the metric that control early stopping. e.g. “auc”, “group_auc”, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.predict" title="Link to this definition">#</a></dt>
<dd><p>Make predictions on the given data, and output predicted scores to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile_name</strong> (<em>str</em>) – Input file name.</p></li>
<li><p><strong>outfile_name</strong> (<em>str</em>) – Output file name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.run_eval" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the given file and returns some evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – A file name that will be evaluated.</p></li>
<li><p><strong>num_ngs</strong> (<em>int</em>) – The number of negative sampling for a positive instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that contains evaluation metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.io.iterator">
<span id="iterators"></span><h3>Iterators<a class="headerlink" href="#module-recommenders.models.deeprec.io.iterator" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.BaseIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.iterator.</span></span><span class="sig-name descname"><span class="pre">BaseIterator</span></span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#BaseIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.BaseIterator" title="Link to this definition">#</a></dt>
<dd><p>Abstract base iterator class</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.BaseIterator.gen_feed_dict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gen_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#BaseIterator.gen_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.BaseIterator.gen_feed_dict" title="Link to this definition">#</a></dt>
<dd><p>Abstract method. Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – A dictionary that maps string name to numpy arrays.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.BaseIterator.load_data_from_file">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#BaseIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.BaseIterator.load_data_from_file" title="Link to this definition">#</a></dt>
<dd><p>Abstract method. Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – Text input file. Each line in this file is an instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.BaseIterator.parser_one_line">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#BaseIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.BaseIterator.parser_one_line" title="Link to this definition">#</a></dt>
<dd><p>Abstract method. Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – A string indicating one instance.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.iterator.</span></span><span class="sig-name descname"><span class="pre">FFMTextIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator" title="Link to this definition">#</a></dt>
<dd><p>Data loader for FFM format based models, such as xDeepFM.
Iterator will not load the whole data into memory. Instead, it loads data into memory
per mini-batch, so that large files can be used as input data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize an iterator. Create the necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key settings such as #_feature and #_field are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – The running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – column splitter in one line.</p></li>
<li><p><strong>ID_spliter</strong> (<em>str</em>) – ID splitter in one line.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator.gen_feed_dict">
<span class="sig-name descname"><span class="pre">gen_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator.gen_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.gen_feed_dict" title="Link to this definition">#</a></dt>
<dd><p>Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – A dictionary that maps string name to numpy arrays.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that maps graph elements to numpy arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.load_data_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – Text input file. Each line in this file is an instance.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An iterator that yields parsed results, in the format of graph <cite>feed_dict</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.parser_one_line" title="Link to this definition">#</a></dt>
<dd><p>Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – A string indicating one instance.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parsed results, including <cite>label</cite>, <cite>features</cite> and <cite>impression_id</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-recommenders.models.deeprec.io.dkn_iterator">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.dkn_iterator.</span></span><span class="sig-name descname"><span class="pre">DKNTextIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator" title="Link to this definition">#</a></dt>
<dd><p>Data loader for the DKN model.
DKN requires a special type of data format, where each instance contains a label, the candidate news article,
and user’s clicked news article. Articles are represented by title words and title entities. Words and entities
are aligned.</p>
<p>Iterator will not load the whole data into memory. Instead, it loads data into memory
per mini-batch, so that large files can be used as input data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize an iterator. Create necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as #_feature and #_field are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – the running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – column spliter in one line.</p></li>
<li><p><strong>ID_spliter</strong> (<em>str</em>) – ID spliter in one line.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_feed_dict">
<span class="sig-name descname"><span class="pre">gen_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.gen_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_feed_dict" title="Link to this definition">#</a></dt>
<dd><p>Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – a dictionary that maps string name to numpy arrays.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that maps graph elements to numpy arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_infer_feed_dict">
<span class="sig-name descname"><span class="pre">gen_infer_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.gen_infer_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_infer_feed_dict" title="Link to this definition">#</a></dt>
<dd><p>Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – a dictionary that maps string name to numpy arrays.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that maps graph elements to numpy arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_data_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – text input file. Each line in this file is an instance.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>obj, list, int</em> –</p>
<ul class="simple">
<li><p>An iterator that yields parsed results, in the format of graph <cite>feed_dict</cite>.</p></li>
<li><p>Impression id list.</p></li>
<li><p>Size of the data in a batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_infer_data_from_file">
<span class="sig-name descname"><span class="pre">load_infer_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.load_infer_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_infer_data_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse data from a file for infer document embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – text input file. Each line in this file is an instance.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>obj, list, int</em> –</p>
<ul class="simple">
<li><p>An iterator that yields parsed results, in the format of graph <cite>feed_dict</cite>.</p></li>
<li><p>Impression id list.</p></li>
<li><p>Size of the data in a batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.parser_one_line" title="Link to this definition">#</a></dt>
<dd><p>Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – a string indicating one instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parsed results including <cite>label</cite>, <cite>candidate_news_index</cite>, <cite>click_news_index</cite>,
<cite>candidate_news_entity_index</cite>, <cite>click_news_entity_index</cite>, <cite>impression_id</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-recommenders.models.deeprec.io.dkn_item2item_iterator">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.dkn_item2item_iterator.</span></span><span class="sig-name descname"><span class="pre">DKNItem2itemTextIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_item2item_iterator.html#DKNItem2itemTextIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_item2item_iterator.html#DKNItem2itemTextIterator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>This new iterator is for DKN’s item-to-item recommendations version.
The tutorial can be found <a class="reference external" href="https://github.com/microsoft/recommenders/blob/main/examples/07_tutorials/KDD2020-tutorial/step4_run_dkn_item2item.ipynb">on this notebook</a>.</p>
<p>Compared with user-to-item recommendations, we don’t need the user behavior module.
So the placeholder can be simplified from the original DKNTextIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – The running graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/dkn_item2item_iterator.html#DKNItem2itemTextIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.load_data_from_file" title="Link to this definition">#</a></dt>
<dd><p>This function will return a mini-batch of data with features,
by looking up <cite>news_word_index</cite> dictionary and <cite>news_entity_index</cite> dictionary according to the news article’s ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – File path. Each line of <cite>infile</cite> is a news article’s ID.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>dict, list, int</em> –</p>
<ul class="simple">
<li><p>A dictionary that maps graph elements to numpy arrays.</p></li>
<li><p>A list with news article’s ID.</p></li>
<li><p>Size of the data in a batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-recommenders.models.deeprec.io.nextitnet_iterator">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.nextitnet_iterator.</span></span><span class="sig-name descname"><span class="pre">NextItNetIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/nextitnet_iterator.html#NextItNetIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator" title="Link to this definition">#</a></dt>
<dd><p>Data loader for the NextItNet model.</p>
<p>NextItNet requires a special type of data format. In training stage, each instance will
produce <cite>(sequence_length * train_num_ngs)</cite> target items and labels, to let NextItNet
output predictions of every item in a sequence except only of the last item.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/nextitnet_iterator.html#NextItNetIterator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize an iterator. Create necessary placeholders for the model.
Different from sequential iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key settings such as #_feature and #_field are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – The running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – Column splitter in one line.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-recommenders.models.deeprec.io.sequential_iterator">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.sequential_iterator.</span></span><span class="sig-name descname"><span class="pre">SequentialIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize an iterator. Create necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key settings such as #_feature and #_field are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – The running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – Column splitter in one line.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.gen_feed_dict">
<span class="sig-name descname"><span class="pre">gen_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.gen_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.gen_feed_dict" title="Link to this definition">#</a></dt>
<dd><p>Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – A dictionary that maps string name to numpy arrays.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that maps graph elements to numpy arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num_ngs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_seq_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.load_data_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> (<em>str</em>) – Text input file. Each line in this file is an instance.</p></li>
<li><p><strong>batch_num_ngs</strong> (<em>int</em>) – The number of negative sampling here in batch.
0 represents that there is no need to do negative sampling here.</p></li>
<li><p><strong>min_seq_length</strong> (<em>int</em>) – The minimum number of a sequence length.
Sequences with length lower than min_seq_length will be ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed results, in the format of graph <cite>feed_dict</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parse_file">
<span class="sig-name descname"><span class="pre">parse_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.parse_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parse_file" title="Link to this definition">#</a></dt>
<dd><p>Parse the file to A list ready to be used for downstream tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_file</strong> – One of train, valid or test file which has never been parsed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list with parsing result.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parser_one_line" title="Link to this definition">#</a></dt>
<dd><p>Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – a string indicating one instance.
This string contains tab-separated values including:
label, user_hash, item_hash, item_cate, operation_time, item_history_sequence,
item_cate_history_sequence, and time_history_sequence.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parsed results including <cite>label</cite>, <cite>user_id</cite>, <cite>item_id</cite>, <cite>item_cate</cite>, <cite>item_history_sequence</cite>, <cite>cate_history_sequence</cite>,
<cite>current_time</cite>, <cite>time_diff</cite>, <cite>time_from_first_action</cite>, <cite>time_to_now</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.DataModel.ImplicitCF">
<span id="data-processing-utilities"></span><h3>Data processing utilities<a class="headerlink" href="#module-recommenders.models.deeprec.DataModel.ImplicitCF" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.DataModel.ImplicitCF.</span></span><span class="sig-name descname"><span class="pre">ImplicitCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF" title="Link to this definition">#</a></dt>
<dd><p>Data processing class for GCN models which use implicit feedback.</p>
<p>Initialize train and test set, create normalized adjacency matrix and sample data for training epochs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adj_dir</strong> (<em>str</em>) – Directory to save / load adjacency matrices. If it is None, adjacency
matrices will be created and will not be saved.</p></li>
<li><p><strong>train</strong> (<em>pandas.DataFrame</em>) – Training data with at least columns (col_user, col_item, col_rating).</p></li>
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – Test data with at least columns (col_user, col_item, col_rating).
test can be None, if so, we only process the training data.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.create_norm_adj_mat">
<span class="sig-name descname"><span class="pre">create_norm_adj_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.create_norm_adj_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.create_norm_adj_mat" title="Link to this definition">#</a></dt>
<dd><p>Create normalized adjacency matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalized adjacency matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.get_norm_adj_mat">
<span class="sig-name descname"><span class="pre">get_norm_adj_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.get_norm_adj_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.get_norm_adj_mat" title="Link to this definition">#</a></dt>
<dd><p>Load normalized adjacency matrix if it exists, otherwise create (and save) it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalized adjacency matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.train_loader">
<span class="sig-name descname"><span class="pre">train_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.train_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.train_loader" title="Link to this definition">#</a></dt>
<dd><p>Sample train data every batch. One positive item and one negative item sampled for each user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>) – Batch size of users.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Sampled users.</p></li>
<li><p>Sampled positive items.</p></li>
<li><p>Sampled negative items.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.deeprec_utils">
<span id="utilities"></span><h3>Utilities<a class="headerlink" href="#module-recommenders.models.deeprec.deeprec_utils" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.HParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">HParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#HParams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="Link to this definition">#</a></dt>
<dd><p>Class for holding hyperparameters for DeepRec algorithms.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.HParams.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#HParams.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.HParams.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create an HParams object from a dictionary of hyperparameter values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hparams_dict</strong> (<em>dict</em>) – Dictionary with the model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.HParams.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#HParams.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.HParams.__repr__" title="Link to this definition">#</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.HParams.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#HParams.values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.HParams.values" title="Link to this definition">#</a></dt>
<dd><p>Return the hyperparameter values as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary with the hyperparameter values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.cal_metric">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">cal_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#cal_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.cal_metric" title="Link to this definition">#</a></dt>
<dd><p>Calculate metrics.</p>
<p>Available options are: <cite>auc</cite>, <cite>rmse</cite>, <cite>logloss</cite>, <cite>acc</cite> (accurary), <cite>f1</cite>, <cite>mean_mrr</cite>,
<cite>ndcg</cite> (format like: ndcg&#64;2;4;6;8), <cite>hit</cite> (format like: hit&#64;2;4;6;8), <cite>group_auc</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>array-like</em>) – Labels.</p></li>
<li><p><strong>preds</strong> (<em>array-like</em>) – Predictions.</p></li>
<li><p><strong>metrics</strong> (<em>list</em>) – List of metric names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cal_metric</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ndcg@2;4;6&quot;</span><span class="p">,</span> <span class="s2">&quot;group_auc&quot;</span><span class="p">])</span>
<span class="go">{&#39;ndcg@2&#39;: 0.4026, &#39;ndcg@4&#39;: 0.4953, &#39;ndcg@6&#39;: 0.5346, &#39;group_auc&#39;: 0.8096}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.check_nn_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">check_nn_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#check_nn_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.check_nn_config" title="Link to this definition">#</a></dt>
<dd><p>Check neural networks configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f_config</strong> (<em>dict</em>) – Neural network configuration.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the parameters are not correct.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.check_type">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">check_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#check_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.check_type" title="Link to this definition">#</a></dt>
<dd><p>Check that the config parameters are the correct type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration dictionary.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If the parameters are not the correct type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.create_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">create_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#create_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.create_hparams" title="Link to this definition">#</a></dt>
<dd><p>Create the model hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flags</strong> (<em>dict</em>) – Dictionary with the model requirements.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameter object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.dcg_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">dcg_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#dcg_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.dcg_score" title="Link to this definition">#</a></dt>
<dd><p>Computing dcg score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dcg scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.download_deeprec_resources">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">download_deeprec_resources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">azure_container_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remote_resource_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#download_deeprec_resources"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.download_deeprec_resources" title="Link to this definition">#</a></dt>
<dd><p>Download resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>azure_container_url</strong> (<em>str</em>) – URL of Azure container.</p></li>
<li><p><strong>data_path</strong> (<em>str</em>) – Path to download the resources.</p></li>
<li><p><strong>remote_resource_name</strong> (<em>str</em>) – Name of the resource.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.flat_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">flat_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#flat_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.flat_config" title="Link to this definition">#</a></dt>
<dd><p>Flat config loaded from a yaml file to a flat dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration loaded from a yaml file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configuration dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.hit_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">hit_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#hit_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.hit_score" title="Link to this definition">#</a></dt>
<dd><p>Computing hit score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>hit score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.load_dict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.load_dict" title="Link to this definition">#</a></dt>
<dd><p>Load the vocabularies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename of user, item or category vocabulary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A saved vocabulary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.load_yaml">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">load_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#load_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.load_yaml" title="Link to this definition">#</a></dt>
<dd><p>Load a yaml file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.mrr_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">mrr_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#mrr_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.mrr_score" title="Link to this definition">#</a></dt>
<dd><p>Computing mrr score metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mrr scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.ndcg_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">ndcg_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#ndcg_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.ndcg_score" title="Link to this definition">#</a></dt>
<dd><p>Computing ndcg score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ndcg scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.prepare_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yaml_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#prepare_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.prepare_hparams" title="Link to this definition">#</a></dt>
<dd><p>Prepare the model hyperparameters and check that all have the correct value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>yaml_file</strong> (<em>str</em>) – YAML file as configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameter object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-recommenders.models.deeprec.models.dkn">
<span id="dkn"></span><h2>DKN<a class="headerlink" href="#module-recommenders.models.deeprec.models.dkn" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn.DKN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.dkn.</span></span><span class="sig-name descname"><span class="pre">DKN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/dkn.html#DKN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn.DKN" title="Link to this definition">#</a></dt>
<dd><p>DKN model (Deep Knowledge-Aware Network)</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>H. Wang, F. Zhang, X. Xie and M. Guo, “DKN: Deep Knowledge-Aware Network for News
Recommendation”, in Proceedings of the 2018 World Wide Web Conference on World
Wide Web, 2018.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn.DKN.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/dkn.html#DKN.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn.DKN.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialization steps for DKN.
Compared with the BaseModel, DKN requires two different pre-computed embeddings,
i.e. word embedding and entity embedding.
After creating these two embedding variables, BaseModel’s <cite>__init__</cite> method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – DKN data loader class.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn.DKN.infer_embedding">
<span class="sig-name descname"><span class="pre">infer_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/dkn.html#DKN.infer_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn.DKN.infer_embedding" title="Link to this definition">#</a></dt>
<dd><p>Infer document embedding in feed_dict with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values for evaluation. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>News embedding in a batch.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn.DKN.run_get_embedding">
<span class="sig-name descname"><span class="pre">run_get_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/dkn.html#DKN.run_get_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn.DKN.run_get_embedding" title="Link to this definition">#</a></dt>
<dd><p>infer document embedding with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile_name</strong> (<em>str</em>) – Input file name, format is [Newsid] [w1,w2,w3…] [e1,e2,e3…]</p></li>
<li><p><strong>outfile_name</strong> (<em>str</em>) – Output file name, format is [Newsid] [embedding]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.models.dkn_item2item">
<span id="dkn-item-to-item"></span><h2>DKN item-to-item<a class="headerlink" href="#module-recommenders.models.deeprec.models.dkn_item2item" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.dkn_item2item.</span></span><span class="sig-name descname"><span class="pre">DKNItem2Item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/dkn_item2item.html#DKNItem2Item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item" title="Link to this definition">#</a></dt>
<dd><p>Class for item-to-item recommendations using DKN.
See <a class="github reference external" href="https://github.com/microsoft/recommenders/blob/main/examples/07_tutorials/KDD2020-tutorial/step4_run_dkn_item2item.ipynb">microsoft/recommenders</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/dkn_item2item.html#DKNItem2Item.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.eval" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the data in <cite>feed_dict</cite> with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values for evaluation. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple with predictions and labels arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/dkn_item2item.html#DKNItem2Item.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.run_eval" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the given file and returns some evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – A file name that will be evaluated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing evaluation metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.models.xDeepFM">
<span id="xdeepfm"></span><h2>xDeepFM<a class="headerlink" href="#module-recommenders.models.deeprec.models.xDeepFM" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.xDeepFM.XDeepFMModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.xDeepFM.</span></span><span class="sig-name descname"><span class="pre">XDeepFMModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/xDeepFM.html#XDeepFMModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.xDeepFM.XDeepFMModel" title="Link to this definition">#</a></dt>
<dd><p>xDeepFM model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>J. Lian, X. Zhou, F. Zhang, Z. Chen, X. Xie, G. Sun, “xDeepFM: Combining Explicit
and Implicit Feature Interactions for Recommender Systems”, in Proceedings of the
24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining,
KDD 2018, London, 2018.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.models.graphrec.lightgcn">
<span id="lightgcn"></span><h2>LightGCN<a class="headerlink" href="#module-recommenders.models.deeprec.models.graphrec.lightgcn" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.graphrec.lightgcn.</span></span><span class="sig-name descname"><span class="pre">LightGCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN" title="Link to this definition">#</a></dt>
<dd><p>LightGCN model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>He, Xiangnan, Kuan Deng, Xiang Wang, Yan Li, Yongdong Zhang, and Meng Wang.
“LightGCN: Simplifying and Powering Graph Convolution Network for Recommendation.” arXiv
preprint arXiv:2002.02126, 2020.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializing the model. Create parameters, placeholders, embeddings and loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams"><em>HParams</em></a>) – A HParams object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>data</strong> (<em>object</em>) – A recommenders.models.deeprec.DataModel.ImplicitCF object, load and process data.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit the model on self.data.train. If eval_epoch is not -1, evaluate the model on <cite>self.data.test</cite>
every <cite>eval_epoch</cite> epoch to observe the training status.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.infer_embedding">
<span class="sig-name descname"><span class="pre">infer_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.infer_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.infer_embedding" title="Link to this definition">#</a></dt>
<dd><p>Export user and item embeddings to csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_file</strong> (<em>str</em>) – Path of file to save user embeddings.</p></li>
<li><p><strong>item_file</strong> (<em>str</em>) – Path of file to save item embeddings.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.load" title="Link to this definition">#</a></dt>
<dd><p>Load an existing model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_path</strong> – Model path.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>IOError</strong> – if the restore operation failed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.recommend_k_items" title="Link to this definition">#</a></dt>
<dd><p>Recommend top K items for all users in the test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – Test data.</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – Number of top items to recommend.</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – Flag to sort top k results.</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – Flag to remove items seen in training from recommendation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Top k recommendation items for each user.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.run_eval" title="Link to this definition">#</a></dt>
<dd><p>Run evaluation on self.data.test.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Results of all metrics in <cite>self.metrics</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.score" title="Link to this definition">#</a></dt>
<dd><p>Score all items for test users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_ids</strong> (<em>np.array</em>) – Users to test.</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – Flag to remove items seen in training from recommendation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of interest of all items for the users.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.models.sequential.asvd">
<span id="a2svd"></span><h2>A2SVD<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.asvd" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.asvd.A2SVDModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.asvd.</span></span><span class="sig-name descname"><span class="pre">A2SVDModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/asvd.html#A2SVDModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.asvd.A2SVDModel" title="Link to this definition">#</a></dt>
<dd><p>A2SVD Model (Attentive Asynchronous Singular Value Decomposition)</p>
<p>It extends ASVD with an attention module.</p>
<dl class="field-list">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>ASVD: Y. Koren, “Factorization Meets the Neighborhood: a Multifaceted Collaborative
Filtering Model”, in Proceedings of the 14th ACM SIGKDD international conference on
Knowledge discovery and data mining, pages 426–434, ACM, 2008.</p>
<p>A2SVD: Z. Yu, J. Lian, A. Mahmoody, G. Liu and X. Xie, “Adaptive User Modeling with
Long and Short-Term Preferences for Personailzed Recommendation”, in Proceedings of
the 28th International Joint Conferences on Artificial Intelligence, IJCAI’19,
Pages 4213-4219, AAAI Press, 2019.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.models.sequential.caser">
<span id="caser"></span><h2>Caser<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.caser" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.caser.CaserModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.caser.</span></span><span class="sig-name descname"><span class="pre">CaserModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/caser.html#CaserModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.caser.CaserModel" title="Link to this definition">#</a></dt>
<dd><p>Caser Model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>J. Tang and K. Wang, “Personalized top-n sequential recommendation via convolutional
sequence embedding”, in Proceedings of the Eleventh ACM International Conference on
Web Search and Data Mining, ACM, 2018.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.caser.CaserModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/caser.html#CaserModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.caser.CaserModel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialization of variables for caser</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams"><em>HParams</em></a>) – A HParams object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="gru">
<h2>GRU<a class="headerlink" href="#gru" title="Link to this heading">#</a></h2>
</section>
<section id="module-recommenders.models.deeprec.models.sequential.nextitnet">
<span id="nextitnet"></span><h2>NextItNet<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.nextitnet" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.nextitnet.NextItNetModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.nextitnet.</span></span><span class="sig-name descname"><span class="pre">NextItNetModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/nextitnet.html#NextItNetModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.nextitnet.NextItNetModel" title="Link to this definition">#</a></dt>
<dd><p>NextItNet Model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Yuan, Fajie, et al. “A Simple Convolutional Generative Network
for Next Item Recommendation”, in Web Search and Data Mining, 2019.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It requires strong sequence with dataset.</p>
</div>
</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.models.sequential.rnn_cell_implement">
<span id="rnn-cells"></span><h2>RNN Cells<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.rnn_cell_implement" title="Link to this heading">#</a></h2>
<p>Module implementing RNN Cells.</p>
<p>This module provides a number of basic commonly used RNN cells, such as LSTM
(Long Short Term Memory) or GRU (Gated Recurrent Unit), and a number of
operators that allow adding dropouts, projections, or embeddings for inputs.
Constructing multi-layer cells is supported by the class <cite>MultiRNNCell</cite>, or by
calling the <cite>rnn</cite> ops several times.</p>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.rnn_cell_implement.</span></span><span class="sig-name descname"><span class="pre">Time4ALSTMCell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/rnn_cell_implement.html#Time4ALSTMCell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/rnn_cell_implement.html#Time4ALSTMCell.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.call" title="Link to this definition">#</a></dt>
<dd><p>Call method for the Time4ALSTMCell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – A 2D Tensor of shape [batch_size, input_size].</p></li>
<li><p><strong>state</strong> – A 2D Tensor of shape [batch_size, state_size].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A 2D Tensor of shape [batch_size, output_size].</p></li>
<li><p>A 2D Tensor of shape [batch_size, state_size].</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.output_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.output_size" title="Link to this definition">#</a></dt>
<dd><p>size of outputs produced by this cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Integer or TensorShape</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.state_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.state_size" title="Link to this definition">#</a></dt>
<dd><p>size(s) of state(s) used by this cell.</p>
<p>It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.rnn_cell_implement.</span></span><span class="sig-name descname"><span class="pre">Time4LSTMCell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/rnn_cell_implement.html#Time4LSTMCell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/rnn_cell_implement.html#Time4LSTMCell.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.call" title="Link to this definition">#</a></dt>
<dd><p>Call method for the Time4LSTMCell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – A 2D Tensor of shape [batch_size, input_size].</p></li>
<li><p><strong>state</strong> – A 2D Tensor of shape [batch_size, state_size].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A 2D Tensor of shape [batch_size, output_size].</p></li>
<li><p>A 2D Tensor of shape [batch_size, state_size].</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.output_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.output_size" title="Link to this definition">#</a></dt>
<dd><p>size of outputs produced by this cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Integer or TensorShape</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.state_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.state_size" title="Link to this definition">#</a></dt>
<dd><p>size(s) of state(s) used by this cell.</p>
<p>It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.</p>
</dd></dl>

</dd></dl>

</section>
<section id="sum">
<h2>SUM<a class="headerlink" href="#sum" title="Link to this heading">#</a></h2>
</section>
<section id="module-recommenders.models.deeprec.models.sequential.sli_rec">
<span id="slirec"></span><h2>SLIRec<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.sli_rec" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sli_rec.SLI_RECModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.sli_rec.</span></span><span class="sig-name descname"><span class="pre">SLI_RECModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/models/sequential/sli_rec.html#SLI_RECModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sli_rec.SLI_RECModel" title="Link to this definition">#</a></dt>
<dd><p>SLI Rec model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Z. Yu, J. Lian, A. Mahmoody, G. Liu and X. Xie, “Adaptive User Modeling with
Long and Short-Term Preferences for Personailzed Recommendation”, in Proceedings of
the 28th International Joint Conferences on Artificial Intelligence, IJCAI’19,
Pages 4213-4219, AAAI Press, 2019.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="embdotbias-utilities">
<h2>EmbDotBias utilities<a class="headerlink" href="#embdotbias-utilities" title="Link to this heading">#</a></h2>
</section>
<section id="module-recommenders.models.lightfm.lightfm_utils">
<span id="lightfm-utilities"></span><h2>LightFM utilities<a class="headerlink" href="#module-recommenders.models.lightfm.lightfm_utils" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.compare_metric">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">compare_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#compare_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.compare_metric" title="Link to this definition">#</a></dt>
<dd><p>Function to combine and prepare list of dataframes into tidy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_list</strong> (<em>list</em>) – List of dataframes</p></li>
<li><p><strong>metrics</strong> (<em>str</em>) – name of metric to be extracted, optional</p></li>
<li><p><strong>stage</strong> (<em>str</em>) – name of model fitting stage to be extracted, optional</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.model_perf_plots">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">model_perf_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#model_perf_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.model_perf_plots" title="Link to this definition">#</a></dt>
<dd><p>Function to plot model performance metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe in tidy format, with [‘epoch’,’level’,’value’] columns</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib axes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.prepare_all_predictions">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_all_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#prepare_all_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.prepare_all_predictions" title="Link to this definition">#</a></dt>
<dd><p>Function to prepare all predictions for evaluation.
:param data: dataframe of all users, items and ratings as loaded
:type data: pandas df
:param uid_map: Keys to map internal user indices to external ids.
:type uid_map: dict
:param iid_map: Keys to map internal item indices to external ids.
:type iid_map: dict
:param interactions: user-item interaction
:type interactions: np.float32 coo_matrix
:param model: fitted LightFM model
:type model: LightFM instance
:param num_threads: number of parallel computation threads
:type num_threads: int
:param user_features: User weights over features
:type user_features: np.float32 csr_matrix
:param item_features: Item weights over features
:type item_features: np.float32 csr_matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>all predictions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.prepare_test_df">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_test_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#prepare_test_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.prepare_test_df" title="Link to this definition">#</a></dt>
<dd><p>Function to prepare test df for evaluation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_idx</strong> (<em>slice</em>) – slice of test indices</p></li>
<li><p><strong>uids</strong> (<em>numpy.ndarray</em>) – Array of internal user indices</p></li>
<li><p><strong>iids</strong> (<em>numpy.ndarray</em>) – Array of internal item indices</p></li>
<li><p><strong>uid_map</strong> (<em>dict</em>) – Keys to map internal user indices to external ids.</p></li>
<li><p><strong>iid_map</strong> (<em>dict</em>) – Keys to map internal item indices to external ids.</p></li>
<li><p><strong>weights</strong> (<em>numpy.float32 coo_matrix</em>) – user-item interaction</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>user-item selected for testing</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.similar_items">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">similar_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#similar_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.similar_items" title="Link to this definition">#</a></dt>
<dd><p>Function to return top N similar items
based on <a class="github reference external" href="https://github.com/lyst/lightfm/issues/244#issuecomment-355305681">lyst/lightfm#244</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item_id</strong> (<em>int</em>) – id of item to be used as reference</p></li>
<li><p><strong>item_features</strong> (<em>scipy sparse CSR matrix</em>) – item feature matric</p></li>
<li><p><strong>model</strong> (<em>LightFM instance</em>) – fitted LightFM model</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of top similar items to return</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>top N most similar items with score</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.similar_users">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">similar_users</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#similar_users"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.similar_users" title="Link to this definition">#</a></dt>
<dd><p>Function to return top N similar users based on <a class="github reference external" href="https://github.com/lyst/lightfm/issues/244#issuecomment-355305681">lyst/lightfm#244</a></p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>user_id (int): id of user to be used as reference
user_features (scipy sparse CSR matrix): user feature matric
model (LightFM instance): fitted LightFM model
N (int): Number of top similar users to return</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>top N most similar users with score</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.track_model_metrics">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">track_model_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#track_model_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.track_model_metrics" title="Link to this definition">#</a></dt>
<dd><p>Function to record model’s performance at each epoch, formats the performance into tidy format,
plots the performance and outputs the performance data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>LightFM instance</em>) – fitted LightFM model</p></li>
<li><p><strong>train_interactions</strong> (<em>scipy sparse COO matrix</em>) – train interactions set</p></li>
<li><p><strong>test_interactions</strong> (<em>scipy sparse COO matrix</em>) – test interaction set</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of recommendations, optional</p></li>
<li><p><strong>no_epochs</strong> (<em>int</em>) – Number of epochs to run, optional</p></li>
<li><p><strong>no_threads</strong> (<em>int</em>) – Number of parallel threads to use, optional</p></li>
<li><p><strong>**kwargs</strong> – other keyword arguments to be passed down</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Performance traces of the fitted model</p></li>
<li><p>Fitted model</p></li>
<li><p>Side effect of the method</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame, LightFM model, matplotlib axes</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.lightgbm.lightgbm_utils">
<span id="lightgbm-utilities"></span><h2>LightGBM utilities<a class="headerlink" href="#module-recommenders.models.lightgbm.lightgbm_utils" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.lightgbm.lightgbm_utils.</span></span><span class="sig-name descname"><span class="pre">NumEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cate_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nume_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder" title="Link to this definition">#</a></dt>
<dd><p>Encode all the categorical features into numerical ones by sequential label encoding, sequential count encoding,
and binary encoding. Additionally, it also filters the low-frequency categories and fills the missing values.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.fit_transform" title="Link to this definition">#</a></dt>
<dd><p>Input a training set (pandas.DataFrame) and return the converted 2 numpy.ndarray (x,y).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New features and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.transform" title="Link to this definition">#</a></dt>
<dd><p>Input a testing / validation set (pandas.DataFrame) and return the converted 2 numpy.ndarray (x,y).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New features and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.unpackbits">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightgbm.lightgbm_utils.</span></span><span class="sig-name descname"><span class="pre">unpackbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightgbm/lightgbm_utils.html#unpackbits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.unpackbits" title="Link to this definition">#</a></dt>
<dd><p>Convert a decimal value numpy.ndarray into multi-binary value numpy.ndarray ([1,2]-&gt;[[0,1],[1,0]])</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Decimal array.</p></li>
<li><p><strong>num_bits</strong> (<em>int</em>) – The max length of the converted binary value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.ncf.dataset">
<span id="ncf"></span><h2>NCF<a class="headerlink" href="#module-recommenders.models.ncf.dataset" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.DataFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">DataFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_test_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#DataFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.DataFile" title="Link to this definition">#</a></dt>
<dd><p>DataFile class for NCF. Iterator to read data from a csv file.
Data must be sorted by user. Includes utilities for loading user data from
file, formatting it and returning a Pandas dataframe.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.DataFile.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_test_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#DataFile.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.DataFile.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Path to file to be processed.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
<li><p><strong>col_test_batch</strong> (<em>str</em>) – Test batch column name.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – If true, set rating &gt; 0 to rating = 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.DataFile.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#DataFile.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.DataFile.load_data" title="Link to this definition">#</a></dt>
<dd><p>Load data for a specified user or test batch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>int</em>) – user or test batch index</p></li>
<li><p><strong>by_user</strong> (<em>bool</em>) – load data by usr if True, else by test batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_test_file_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neg_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_replacement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset" title="Link to this definition">#</a></dt>
<dd><p>Dataset class for NCF</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_test_file_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neg_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_replacement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#Dataset.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>str</em>) – Path to training dataset file.</p></li>
<li><p><strong>test_file</strong> (<em>str</em>) – Path to test dataset file for leave-one-out evaluation.</p></li>
<li><p><strong>test_file_full</strong> (<em>str</em>) – Path to full test dataset file including negative samples.</p></li>
<li><p><strong>overwrite_test_file_full</strong> (<em>bool</em>) – If true, recreate and overwrite test_file_full.</p></li>
<li><p><strong>n_neg</strong> (<em>int</em>) – Number of negative samples per positive example for training set.</p></li>
<li><p><strong>n_neg_test</strong> (<em>int</em>) – Number of negative samples per positive example for test set.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – If true, set rating &gt; 0 to rating = 1.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>sample_with_replacement</strong> (<em>bool</em>) – If true, sample negative examples with replacement,
otherwise without replacement.</p></li>
<li><p><strong>print_warnings</strong> (<em>bool</em>) – If true, prints warnings if sampling without replacement and
there are not enough items to sample from to satisfy n_neg or n_neg_test.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset.test_loader">
<span class="sig-name descname"><span class="pre">test_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yield_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#Dataset.test_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset.test_loader" title="Link to this definition">#</a></dt>
<dd><p>Generator for serving batches of test data for leave-one-out evaluation. Data is loaded from test_file_full.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>yield_id</strong> (<em>bool</em>) – If true, return assigned user and item IDs, else return original values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset.train_loader">
<span class="sig-name descname"><span class="pre">train_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yield_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#Dataset.train_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset.train_loader" title="Link to this definition">#</a></dt>
<dd><p>Generator for serving batches of training data. Positive examples are loaded from the
original training file, to which negative samples are added. Data is loaded in memory into a
shuffle buffer up to a maximum of shuffle_size rows, before the data is shuffled and released.
If out-of-memory errors are encountered, try reducing shuffle_size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Number of examples in each batch.</p></li>
<li><p><strong>shuffle_size</strong> (<em>int</em>) – Maximum number of examples in shuffle buffer.</p></li>
<li><p><strong>yield_id</strong> (<em>bool</em>) – If true, return assigned user and item IDs, else return original values.</p></li>
<li><p><strong>write_to</strong> (<em>str</em>) – Path of file to write full dataset (including negative examples).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.EmptyFileException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">EmptyFileException</span></span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#EmptyFileException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.EmptyFileException" title="Link to this definition">#</a></dt>
<dd><p>Exception raised if file is empty</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.FileNotSortedException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">FileNotSortedException</span></span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#FileNotSortedException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.FileNotSortedException" title="Link to this definition">#</a></dt>
<dd><p>Exception raised if file is not sorted correctly</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.MissingFieldsException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">MissingFieldsException</span></span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#MissingFieldsException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.MissingFieldsException" title="Link to this definition">#</a></dt>
<dd><p>Exception raised if file is missing expected fields</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.MissingUserException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">MissingUserException</span></span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#MissingUserException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.MissingUserException" title="Link to this definition">#</a></dt>
<dd><p>Exception raised if user is not in file</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.NegativeSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">NegativeSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_positive_item_pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_replacement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#NegativeSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.NegativeSampler" title="Link to this definition">#</a></dt>
<dd><p>NegativeSampler class for NCF. Samples a subset of negative items from a given population of items.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.NegativeSampler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_positive_item_pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_replacement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#NegativeSampler.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.NegativeSampler.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> (<em>str</em><em> or </em><em>int</em>) – User to be sampled for.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of required samples.</p></li>
<li><p><strong>user_positive_item_pool</strong> (<em>set</em>) – Set of items with which user has previously interacted.</p></li>
<li><p><strong>item_pool</strong> (<em>set</em>) – Set of all items in population.</p></li>
<li><p><strong>sample_with_replacement</strong> (<em>bool</em>) – If true, sample negative examples with replacement,
otherwise without replacement.</p></li>
<li><p><strong>print_warnings</strong> (<em>bool</em>) – If true, prints warnings if sampling without replacement and
there are not enough items to sample from to satisfy n_neg or n_neg_test.</p></li>
<li><p><strong>training</strong> (<em>bool</em>) – Set to true if sampling for the training set or false if for the test set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.NegativeSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#NegativeSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.NegativeSampler.sample" title="Link to this definition">#</a></dt>
<dd><p>Method for sampling uniformly from a population of negative items</p>
<p>Returns: list</p>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-recommenders.models.ncf.ncf_singlenode">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.ncf_singlenode.</span></span><span class="sig-name descname"><span class="pre">NCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NeuMF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[16,</span> <span class="pre">8,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/ncf_singlenode.html#NCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF" title="Link to this definition">#</a></dt>
<dd><p>Neural Collaborative Filtering (NCF) implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>He, Xiangnan, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. “Neural collaborative filtering.”
In Proceedings of the 26th International Conference on World Wide Web, pp. 173-182. International World Wide Web
Conferences Steering Committee, 2017. Link: <a class="reference external" href="https://www.comp.nus.edu.sg/~xiangnan/papers/ncf.pdf">https://www.comp.nus.edu.sg/~xiangnan/papers/ncf.pdf</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NeuMF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[16,</span> <span class="pre">8,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_users</strong> (<em>int</em>) – Number of users in the dataset.</p></li>
<li><p><strong>n_items</strong> (<em>int</em>) – Number of items in the dataset.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Model type.</p></li>
<li><p><strong>n_factors</strong> (<em>int</em>) – Dimension of latent space.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em>) – Number of layers for MLP.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Number of epochs for training.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>) – Learning rate.</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – Whether to show the training output or not.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit model with training data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>NCFDataset</em>) – initilized Dataset in ./dataset.py</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neumf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.load" title="Link to this definition">#</a></dt>
<dd><p>Load model parameters for further use.</p>
<p>GMF model –&gt; load parameters in <cite>gmf_dir</cite></p>
<p>MLP model –&gt; load parameters in <cite>mlp_dir</cite></p>
<p>NeuMF model –&gt; load parameters in <cite>neumf_dir</cite> or in <cite>gmf_dir</cite> and <cite>mlp_dir</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmf_dir</strong> (<em>str</em>) – Directory name for GMF model.</p></li>
<li><p><strong>mlp_dir</strong> (<em>str</em>) – Directory name for MLP model.</p></li>
<li><p><strong>neumf_dir</strong> (<em>str</em>) – Directory name for neumf model.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – the concatenation hyper-parameter for gmf and mlp output layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Load parameters in this model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.predict" title="Link to this definition">#</a></dt>
<dd><p>Predict function of this trained model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_input</strong> (<em>list</em><em> or </em><em>element</em><em> of </em><em>list</em>) – userID or userID list</p></li>
<li><p><strong>item_input</strong> (<em>list</em><em> or </em><em>element</em><em> of </em><em>list</em>) – itemID or itemID list</p></li>
<li><p><strong>is_list</strong> (<em>bool</em>) – if true, the input is list type
noting that list-wise type prediction is faster than element-wise’s.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of predicted rating or predicted rating score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.save" title="Link to this definition">#</a></dt>
<dd><p>Save model parameters in <cite>dir_name</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_name</strong> (<em>str</em>) – directory name, which should be a folder name instead of file name
we will create a new directory if not existing.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="newsrec-utilities">
<h2>NewsRec utilities<a class="headerlink" href="#newsrec-utilities" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Base model<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<dl class="py class" id="module-recommenders.models.newsrec.models.base_model">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.base_model.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/base_model.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel" title="Link to this definition">#</a></dt>
<dd><p>Basic class of models</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.hparams">
<span class="sig-name descname"><span class="pre">hparams</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.hparams" title="Link to this definition">#</a></dt>
<dd><p>A HParams object, holds the entire set of hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.train_iterator">
<span class="sig-name descname"><span class="pre">train_iterator</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.train_iterator" title="Link to this definition">#</a></dt>
<dd><p>An iterator to load the data in training steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.test_iterator">
<span class="sig-name descname"><span class="pre">test_iterator</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.test_iterator" title="Link to this definition">#</a></dt>
<dd><p>An iterator to load the data in testing steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.graph" title="Link to this definition">#</a></dt>
<dd><p>An optional graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.seed" title="Link to this definition">#</a></dt>
<dd><p>Random seed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializing the model. Create common logics which are needed by all deeprec models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams"><em>HParams</em></a>) – A HParams object, holds the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_batch_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.eval" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the data in feed_dict with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values for evaluation. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of evaluated results, including total loss value, data loss value, predicted scores, and ground-truth labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_behaviors_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_behaviors_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_news_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_behaviors_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit the model with train_file. Evaluate the model on valid_file per epoch to observe the training status.
If test_news_file is not None, evaluate it too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>str</em>) – training data set.</p></li>
<li><p><strong>valid_file</strong> (<em>str</em>) – validation set.</p></li>
<li><p><strong>test_news_file</strong> (<em>str</em>) – test set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.group_labels">
<span class="sig-name descname"><span class="pre">group_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.group_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.group_labels" title="Link to this definition">#</a></dt>
<dd><p>Devide labels and preds into several group according to values in group keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list</em>) – ground truth label list.</p></li>
<li><p><strong>preds</strong> (<em>list</em>) – prediction score list.</p></li>
<li><p><strong>group_keys</strong> (<em>list</em>) – group key list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Keys after group.</p></li>
<li><p>Labels after group.</p></li>
<li><p>Preds after group.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list, list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behaviors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.run_eval" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the given file and returns some evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – A file name that will be evaluated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that contains evaluation metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_batch_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.train" title="Link to this definition">#</a></dt>
<dd><p>Go through the optimization step once with training data in feed_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values to train the model. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of values, including update operation, total loss, data loss, and merged summary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id2">
<h3>Iterators<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<dl class="py class" id="module-recommenders.models.newsrec.io.mind_iterator">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.io.mind_iterator.</span></span><span class="sig-name descname"><span class="pre">MINDIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator" title="Link to this definition">#</a></dt>
<dd><p>Train data loader for NAML model.
The model require a special type of data format, where each instance contains a label, impresion id, user id,
the candidate news articles and user’s clicked news article. Articles are represented by title words,
body words, verts and subverts.</p>
<p>Iterator will not load the whole data into memory. Instead, it loads data into memory
per mini-batch, so that large files can be used as input data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.col_spliter">
<span class="sig-name descname"><span class="pre">col_spliter</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.col_spliter" title="Link to this definition">#</a></dt>
<dd><p>column spliter in one line.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.ID_spliter">
<span class="sig-name descname"><span class="pre">ID_spliter</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.ID_spliter" title="Link to this definition">#</a></dt>
<dd><p>ID spliter in one line.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.batch_size" title="Link to this definition">#</a></dt>
<dd><p>the samples num in one batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.title_size">
<span class="sig-name descname"><span class="pre">title_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.title_size" title="Link to this definition">#</a></dt>
<dd><p>max word num in news title.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.his_size">
<span class="sig-name descname"><span class="pre">his_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.his_size" title="Link to this definition">#</a></dt>
<dd><p>max clicked news num in user click history.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.npratio">
<span class="sig-name descname"><span class="pre">npratio</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.npratio" title="Link to this definition">#</a></dt>
<dd><p>negaive and positive ratio used in negative sampling. -1 means no need of negtive sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize an iterator. Create necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as head_num and head_dim are there.</p></li>
<li><p><strong>npratio</strong> (<em>int</em>) – negaive and positive ratio used in negative sampling. -1 means no need of negtive sampling.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – column spliter in one line.</p></li>
<li><p><strong>ID_spliter</strong> (<em>str</em>) – ID spliter in one line.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_behaviors">
<span class="sig-name descname"><span class="pre">init_behaviors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaviors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.init_behaviors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_behaviors" title="Link to this definition">#</a></dt>
<dd><p>init behavior logs given behaviors file.</p>
<p>Args:
behaviors_file: path of behaviors file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_news">
<span class="sig-name descname"><span class="pre">init_news</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.init_news"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_news" title="Link to this definition">#</a></dt>
<dd><p>init news information given news file, such as news_title_index and nid2index.
:param news_file: path of news file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_data_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse data from news file and behavior file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p></li>
<li><p><strong>beahaviros_file</strong> (<em>str</em>) – A file contains information of user impressions.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed results, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_dict">
<span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_dict" title="Link to this definition">#</a></dt>
<dd><p>load pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>file</em>) – file path</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pickle loaded object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_impression_from_file">
<span class="sig-name descname"><span class="pre">load_impression_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaivors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_impression_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_impression_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse impression data from behaivors file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>behaivors_file</strong> (<em>str</em>) – A file contains several informations of behaviros.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed impression data, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_news_from_file">
<span class="sig-name descname"><span class="pre">load_news_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_news_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_news_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse user data from news file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed news feature, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_user_from_file">
<span class="sig-name descname"><span class="pre">load_user_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_user_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_user_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse user data from news file and behavior file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p></li>
<li><p><strong>beahaviros_file</strong> (<em>str</em>) – A file contains information of user impressions.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed user feature, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.parser_one_line" title="Link to this definition">#</a></dt>
<dd><p>Parse one behavior sample into feature values.
if npratio is larger than 0, return negtive sampled result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line</strong> (<em>int</em>) – sample index.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>list</em> – Parsed results including label, impression id , user id,
candidate_title_index, clicked_title_index.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-recommenders.models.newsrec.io.mind_all_iterator">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.io.mind_all_iterator.</span></span><span class="sig-name descname"><span class="pre">MINDAllIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator" title="Link to this definition">#</a></dt>
<dd><p>Train data loader for NAML model.
The model require a special type of data format, where each instance contains a label, impresion id, user id,
the candidate news articles and user’s clicked news article. Articles are represented by title words,
body words, verts and subverts.</p>
<p>Iterator will not load the whole data into memory. Instead, it loads data into memory
per mini-batch, so that large files can be used as input data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.col_spliter">
<span class="sig-name descname"><span class="pre">col_spliter</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.col_spliter" title="Link to this definition">#</a></dt>
<dd><p>column spliter in one line.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.ID_spliter">
<span class="sig-name descname"><span class="pre">ID_spliter</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.ID_spliter" title="Link to this definition">#</a></dt>
<dd><p>ID spliter in one line.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.batch_size" title="Link to this definition">#</a></dt>
<dd><p>the samples num in one batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.title_size">
<span class="sig-name descname"><span class="pre">title_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.title_size" title="Link to this definition">#</a></dt>
<dd><p>max word num in news title.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.body_size">
<span class="sig-name descname"><span class="pre">body_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.body_size" title="Link to this definition">#</a></dt>
<dd><p>max word num in news body (abstract used in MIND).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.his_size">
<span class="sig-name descname"><span class="pre">his_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.his_size" title="Link to this definition">#</a></dt>
<dd><p>max clicked news num in user click history.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.npratio">
<span class="sig-name descname"><span class="pre">npratio</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.npratio" title="Link to this definition">#</a></dt>
<dd><p>negaive and positive ratio used in negative sampling. -1 means no need of negtive sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize an iterator. Create necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as head_num and head_dim are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – the running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – column spliter in one line.</p></li>
<li><p><strong>ID_spliter</strong> (<em>str</em>) – ID spliter in one line.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_behaviors">
<span class="sig-name descname"><span class="pre">init_behaviors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaviors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.init_behaviors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_behaviors" title="Link to this definition">#</a></dt>
<dd><p>Init behavior logs given behaviors file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>behaviors_file</strong> (<em>str</em>) – path of behaviors file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_news">
<span class="sig-name descname"><span class="pre">init_news</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.init_news"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_news" title="Link to this definition">#</a></dt>
<dd><p>Init news information given news file, such as <cite>news_title_index</cite>, <cite>news_abstract_index</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>news_file</strong> – path of news file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_data_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p></li>
<li><p><strong>beahaviros_file</strong> (<em>str</em>) – A file contains information of user impressions.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed results, in the format of graph feed_dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_dict">
<span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_dict" title="Link to this definition">#</a></dt>
<dd><p>Load pickled file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>file</em>) – File path</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pickle load obj</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_impression_from_file">
<span class="sig-name descname"><span class="pre">load_impression_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaivors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_impression_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_impression_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse impression data from behaivors file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>behaivors_file</strong> (<em>str</em>) – A file contains several informations of behaviros.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed impression data, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_news_from_file">
<span class="sig-name descname"><span class="pre">load_news_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_news_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_news_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse user data from news file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed news feature, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_user_from_file">
<span class="sig-name descname"><span class="pre">load_user_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_user_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_user_from_file" title="Link to this definition">#</a></dt>
<dd><p>Read and parse user data from news file and behavior file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p></li>
<li><p><strong>beahaviros_file</strong> (<em>str</em>) – A file contains information of user impressions.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed user feature, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.parser_one_line" title="Link to this definition">#</a></dt>
<dd><p>Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – a string indicating one instance.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>list</em> – Parsed results including label, impression id , user id,
candidate_title_index, clicked_title_index,
candidate_ab_index, clicked_ab_index,
candidate_vert_index, clicked_vert_index,
candidate_subvert_index, clicked_subvert_index,</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id3">
<h3>Utilities<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<dl class="py class" id="module-recommenders.models.newsrec.models.layers">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">AttLayer2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#AttLayer2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2" title="Link to this definition">#</a></dt>
<dd><p>Soft alignment attention implement.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.dim" title="Link to this definition">#</a></dt>
<dd><p>attention hidden dim</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialization steps for AttLayer2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em>) – attention hidden dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.build" title="Link to this definition">#</a></dt>
<dd><p>Initialization for variables in AttLayer2
There are there variables in AttLayer2, i.e. W, b and q.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<em>object</em>) – shape of input tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.call" title="Link to this definition">#</a></dt>
<dd><p>Core implementation of soft attention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>object</em>) – input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>weighted sum of input tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.compute_mask">
<span class="sig-name descname"><span class="pre">compute_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.compute_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.compute_mask" title="Link to this definition">#</a></dt>
<dd><p>Compte output mask value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>object</em>) – input tensor.</p></li>
<li><p><strong>input_mask</strong> – input mask</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.compute_output_shape" title="Link to this definition">#</a></dt>
<dd><p>Compute shape of output tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<em>tuple</em>) – shape of input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>shape of output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.ComputeMasking">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">ComputeMasking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#ComputeMasking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.ComputeMasking" title="Link to this definition">#</a></dt>
<dd><p>Compute if inputs contains zero value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True for values not equal to zero.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool tensor</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.ComputeMasking.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#ComputeMasking.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.ComputeMasking.call" title="Link to this definition">#</a></dt>
<dd><p>Call method for ComputeMasking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>object</em>) – input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True for values not equal to zero.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.ComputeMasking.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#ComputeMasking.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.ComputeMasking.compute_output_shape" title="Link to this definition">#</a></dt>
<dd><p>Computes the output shape of the layer.</p>
<p>This method will cause the layer’s state to be built, if that has not
happened before. This requires that the layer will later be used with
inputs that match the input shape provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Shape tuple (tuple of integers) or <cite>tf.TensorShape</cite>,
or structure of shape tuples / <cite>tf.TensorShape</cite> instances
(one per output tensor of the layer).
Shape tuples can include None for free dimensions,
instead of an integer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>tf.TensorShape</cite> instance
or structure of <cite>tf.TensorShape</cite> instances.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.OverwriteMasking">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">OverwriteMasking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#OverwriteMasking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.OverwriteMasking" title="Link to this definition">#</a></dt>
<dd><p>Set values at specific positions to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>list</em>) – value tensor and mask tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tensor after setting values to zero.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.OverwriteMasking.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#OverwriteMasking.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.build" title="Link to this definition">#</a></dt>
<dd><p>Creates the variables of the layer (for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call. It is invoked automatically before
the first execution of <cite>call()</cite>.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses
(at the discretion of the subclass implementer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.OverwriteMasking.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#OverwriteMasking.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.call" title="Link to this definition">#</a></dt>
<dd><p>Call method for OverwriteMasking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>list</em>) – value tensor and mask tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tensor after setting values to zero.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.OverwriteMasking.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#OverwriteMasking.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.compute_output_shape" title="Link to this definition">#</a></dt>
<dd><p>Computes the output shape of the layer.</p>
<p>This method will cause the layer’s state to be built, if that has not
happened before. This requires that the layer will later be used with
inputs that match the input shape provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Shape tuple (tuple of integers) or <cite>tf.TensorShape</cite>,
or structure of shape tuples / <cite>tf.TensorShape</cite> instances
(one per output tensor of the layer).
Shape tuples can include None for free dimensions,
instead of an integer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>tf.TensorShape</cite> instance
or structure of <cite>tf.TensorShape</cite> instances.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.PersonalizedAttentivePooling">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">PersonalizedAttentivePooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#PersonalizedAttentivePooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.PersonalizedAttentivePooling" title="Link to this definition">#</a></dt>
<dd><p>Soft alignment attention implement.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.dim1">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">dim1</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.layers.dim1" title="Link to this definition">#</a></dt>
<dd><p>first dimention of value shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.dim2">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">dim2</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.layers.dim2" title="Link to this definition">#</a></dt>
<dd><p>second dimention of value shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.dim3">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">dim3</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.layers.dim3" title="Link to this definition">#</a></dt>
<dd><p>shape of query</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>weighted summary of inputs value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">SelfAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#SelfAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention" title="Link to this definition">#</a></dt>
<dd><p>Multi-head self attention implement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiheads</strong> (<em>int</em>) – The number of heads.</p></li>
<li><p><strong>head_dim</strong> (<em>object</em>) – Dimension of each head.</p></li>
<li><p><strong>mask_right</strong> (<em>boolean</em>) – whether to mask right words.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Weighted sum after attention.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.Mask">
<span class="sig-name descname"><span class="pre">Mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'add'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.Mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.Mask" title="Link to this definition">#</a></dt>
<dd><p>Mask operation used in multi-head self attention</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_len</strong> (<em>object</em>) – sequence length of inputs.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – mode of mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tensors after masking.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiheads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialization steps for AttLayer2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiheads</strong> (<em>int</em>) – The number of heads.</p></li>
<li><p><strong>head_dim</strong> (<em>object</em>) – Dimension of each head.</p></li>
<li><p><strong>mask_right</strong> (<em>boolean</em>) – Whether to mask right words.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.build" title="Link to this definition">#</a></dt>
<dd><p>Initialization for variables in SelfAttention.
There are three variables in SelfAttention, i.e. WQ, WK ans WV.
WQ is used for linear transformation of query.
WK is used for linear transformation of key.
WV is used for linear transformation of value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<em>object</em>) – shape of input tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">QKVs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.call" title="Link to this definition">#</a></dt>
<dd><p>Core logic of multi-head self attention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>QKVs</strong> (<em>list</em>) – inputs of multi-head self attention i.e. query, key and value.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ouput tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.compute_output_shape" title="Link to this definition">#</a></dt>
<dd><p>Compute shape of output tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>output shape tuple.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.get_config" title="Link to this definition">#</a></dt>
<dd><p>add multiheads, multiheads and mask_right into layer config.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>config of SelfAttention layer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function" id="module-recommenders.models.newsrec.newsrec_utils">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.check_nn_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">check_nn_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#check_nn_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.check_nn_config" title="Link to this definition">#</a></dt>
<dd><p>Check neural networks configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f_config</strong> (<em>dict</em>) – Neural network configuration.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the parameters are not correct.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.check_type">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">check_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#check_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.check_type" title="Link to this definition">#</a></dt>
<dd><p>Check that the config parameters are the correct type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration dictionary.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If the parameters are not the correct type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.create_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">create_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#create_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.create_hparams" title="Link to this definition">#</a></dt>
<dd><p>Create the model hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flags</strong> (<em>dict</em>) – Dictionary with the model requirements.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameter object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.get_mind_data_set">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">get_mind_data_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#get_mind_data_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.get_mind_data_set" title="Link to this definition">#</a></dt>
<dd><p>Get MIND dataset address</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type</strong> (<em>str</em>) – type of mind dataset, must be in [‘large’, ‘small’, ‘demo’]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data url and train valid dataset name</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.newsample">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">newsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#newsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.newsample" title="Link to this definition">#</a></dt>
<dd><p>Sample ratio samples from news list.
If length of news is less than ratio, pad zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news</strong> (<em>list</em>) – input news list</p></li>
<li><p><strong>ratio</strong> (<em>int</em>) – sample number</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of sample list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.prepare_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yaml_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#prepare_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.prepare_hparams" title="Link to this definition">#</a></dt>
<dd><p>Prepare the model hyperparameters and check that all have the correct value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>yaml_file</strong> (<em>str</em>) – YAML file as configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameter object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.word_tokenize">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">word_tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#word_tokenize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.word_tokenize" title="Link to this definition">#</a></dt>
<dd><p>Split sentence into word list using regex.
:param sent: Input sentence
:type sent: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>word list</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-recommenders.models.newsrec.models.lstur">
<span id="lstur"></span><h2>LSTUR<a class="headerlink" href="#module-recommenders.models.newsrec.models.lstur" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.lstur.LSTURModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.lstur.</span></span><span class="sig-name descname"><span class="pre">LSTURModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/lstur.html#LSTURModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.lstur.LSTURModel" title="Link to this definition">#</a></dt>
<dd><p>LSTUR model(Neural News Recommendation with Multi-Head Self-Attention)</p>
<p>Mingxiao An, Fangzhao Wu, Chuhan Wu, Kun Zhang, Zheng Liu and Xing Xie:
Neural News Recommendation with Long- and Short-term User Representations, ACL 2019</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.lstur.LSTURModel.word2vec_embedding">
<span class="sig-name descname"><span class="pre">word2vec_embedding</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.lstur.LSTURModel.word2vec_embedding" title="Link to this definition">#</a></dt>
<dd><p>Pretrained word embedding matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.lstur.LSTURModel.hparam">
<span class="sig-name descname"><span class="pre">hparam</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.lstur.LSTURModel.hparam" title="Link to this definition">#</a></dt>
<dd><p>Global hyper-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.lstur.LSTURModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/lstur.html#LSTURModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.lstur.LSTURModel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialization steps for LSTUR.
Compared with the BaseModel, LSTUR need word embedding.
After creating word embedding matrix, BaseModel’s __init__ method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as type and gru_unit are there.</p></li>
<li><p><strong>iterator_creator_train</strong> (<em>object</em>) – LSTUR data loader class for train data.</p></li>
<li><p><strong>iterator_creator_test</strong> (<em>object</em>) – LSTUR data loader class for test and validation data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.newsrec.models.naml">
<span id="naml"></span><h2>NAML<a class="headerlink" href="#module-recommenders.models.newsrec.models.naml" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.naml.NAMLModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.naml.</span></span><span class="sig-name descname"><span class="pre">NAMLModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/naml.html#NAMLModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.naml.NAMLModel" title="Link to this definition">#</a></dt>
<dd><p>NAML model(Neural News Recommendation with Attentive Multi-View Learning)</p>
<p>Chuhan Wu, Fangzhao Wu, Mingxiao An, Jianqiang Huang, Yongfeng Huang and Xing Xie,
Neural News Recommendation with Attentive Multi-View Learning, IJCAI 2019</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.naml.NAMLModel.word2vec_embedding">
<span class="sig-name descname"><span class="pre">word2vec_embedding</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.naml.NAMLModel.word2vec_embedding" title="Link to this definition">#</a></dt>
<dd><p>Pretrained word embedding matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.naml.NAMLModel.hparam">
<span class="sig-name descname"><span class="pre">hparam</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.naml.NAMLModel.hparam" title="Link to this definition">#</a></dt>
<dd><p>Global hyper-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.naml.NAMLModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/naml.html#NAMLModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.naml.NAMLModel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialization steps for NAML.
Compared with the BaseModel, NAML need word embedding.
After creating word embedding matrix, BaseModel’s __init__ method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as filter_num are there.</p></li>
<li><p><strong>iterator_creator_train</strong> (<em>object</em>) – NAML data loader class for train data.</p></li>
<li><p><strong>iterator_creator_test</strong> (<em>object</em>) – NAML data loader class for test and validation data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.newsrec.models.npa">
<span id="npa"></span><h2>NPA<a class="headerlink" href="#module-recommenders.models.newsrec.models.npa" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.npa.NPAModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.npa.</span></span><span class="sig-name descname"><span class="pre">NPAModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/npa.html#NPAModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.npa.NPAModel" title="Link to this definition">#</a></dt>
<dd><p>NPA model(Neural News Recommendation with Attentive Multi-View Learning)</p>
<p>Chuhan Wu, Fangzhao Wu, Mingxiao An, Jianqiang Huang, Yongfeng Huang and Xing Xie:
NPA: Neural News Recommendation with Personalized Attention, KDD 2019, ADS track.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.npa.NPAModel.word2vec_embedding">
<span class="sig-name descname"><span class="pre">word2vec_embedding</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.npa.NPAModel.word2vec_embedding" title="Link to this definition">#</a></dt>
<dd><p>Pretrained word embedding matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.npa.NPAModel.hparam">
<span class="sig-name descname"><span class="pre">hparam</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.npa.NPAModel.hparam" title="Link to this definition">#</a></dt>
<dd><p>Global hyper-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.npa.NPAModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/npa.html#NPAModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.npa.NPAModel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialization steps for MANL.
Compared with the BaseModel, NPA need word embedding.
After creating word embedding matrix, BaseModel’s __init__ method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as filter_num are there.</p></li>
<li><p><strong>iterator_creator_train</strong> (<em>object</em>) – NPA data loader class for train data.</p></li>
<li><p><strong>iterator_creator_test</strong> (<em>object</em>) – NPA data loader class for test and validation data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.newsrec.models.nrms">
<span id="nrms"></span><h2>NRMS<a class="headerlink" href="#module-recommenders.models.newsrec.models.nrms" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.nrms.NRMSModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.nrms.</span></span><span class="sig-name descname"><span class="pre">NRMSModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/nrms.html#NRMSModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.nrms.NRMSModel" title="Link to this definition">#</a></dt>
<dd><p>NRMS model(Neural News Recommendation with Multi-Head Self-Attention)</p>
<p>Chuhan Wu, Fangzhao Wu, Suyu Ge, Tao Qi, Yongfeng Huang,and Xing Xie, “Neural News
Recommendation with Multi-Head Self-Attention” in Proceedings of the 2019 Conference
on Empirical Methods in Natural Language Processing and the 9th International Joint Conference
on Natural Language Processing (EMNLP-IJCNLP)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.nrms.NRMSModel.word2vec_embedding">
<span class="sig-name descname"><span class="pre">word2vec_embedding</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.nrms.NRMSModel.word2vec_embedding" title="Link to this definition">#</a></dt>
<dd><p>Pretrained word embedding matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.nrms.NRMSModel.hparam">
<span class="sig-name descname"><span class="pre">hparam</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.nrms.NRMSModel.hparam" title="Link to this definition">#</a></dt>
<dd><p>Global hyper-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.nrms.NRMSModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/models/nrms.html#NRMSModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.nrms.NRMSModel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialization steps for NRMS.
Compared with the BaseModel, NRMS need word embedding.
After creating word embedding matrix, BaseModel’s __init__ method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as head_num and head_dim are there.</p></li>
<li><p><strong>iterator_creator_train</strong> (<em>object</em>) – NRMS data loader class for train data.</p></li>
<li><p><strong>iterator_creator_test</strong> (<em>object</em>) – NRMS data loader class for test and validation data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.rbm.rbm">
<span id="rbm"></span><h2>RBM<a class="headerlink" href="#module-recommenders.models.rbm.rbm" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.rbm.rbm.</span></span><span class="sig-name descname"><span class="pre">RBM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">possible_ratings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visible_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_stdv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_protocol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[50,</span> <span class="pre">70,</span> <span class="pre">80,</span> <span class="pre">90,</span> <span class="pre">100]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM" title="Link to this definition">#</a></dt>
<dd><p>Restricted  Boltzmann Machine</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">possible_ratings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visible_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_stdv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_protocol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[50,</span> <span class="pre">70,</span> <span class="pre">80,</span> <span class="pre">90,</span> <span class="pre">100]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.__init__" title="Link to this definition">#</a></dt>
<dd><p>Implementation of a multinomial Restricted Boltzmann Machine for collaborative filtering
in numpy/pandas/tensorflow</p>
<p>Based on the article by Ruslan Salakhutdinov, Andriy Mnih and Geoffrey Hinton
<a class="reference external" href="https://www.cs.toronto.edu/~rsalakhu/papers/rbmcf.pdf">https://www.cs.toronto.edu/~rsalakhu/papers/rbmcf.pdf</a></p>
<p>In this implementation we use multinomial units instead of the one-hot-encoded used in
the paper. This means that the weights are rank 2 (matrices) instead of rank 3 tensors.</p>
<p>Basic mechanics:</p>
<p>1) A computational graph is created when the RBM class is instantiated.
For an item based recommender this consists of:
visible units: The number n_visible of visible units equals the number of items
hidden units : hyperparameter to fix during training</p>
<ol class="arabic simple" start="2">
<li><p>Gibbs Sampling:</p></li>
</ol>
<p>2.1) for each training epoch, the visible units are first clamped on the data</p>
<p>2.2) The activation probability of the hidden units, given a linear combination of
the visibles, is evaluated P(h=1|phi_v). The latter is then used to sample the
value of the hidden units.</p>
<p>2.3) The probability P(v=l|phi_h) is evaluated, where l=1,..,r are the ratings (e.g.
r=5 for the movielens dataset). In general, this is a multinomial distribution,
from which we sample the value of v.</p>
<p>2.4) This step is repeated k times, where k increases as optimization converges. It is
essential to fix to zero the original unrated items during the all learning process.</p>
<p>3) Optimization:
The free energy of the visible units given the hidden is evaluated at the beginning (F_0)
and after k steps of Bernoulli sampling (F_k). The weights and biases are updated by
minimizing the differene F_0 - F_k.</p>
<p>4) Inference:
Once the joint probability distribution P(v,h) is learned, this is used to generate ratings
for unrated items for all users</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.batch_training">
<span class="sig-name descname"><span class="pre">batch_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_minibatches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.batch_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.batch_training" title="Link to this definition">#</a></dt>
<dd><p>Perform training over input minibatches. If <cite>self.with_metrics</cite> is False,
no online metrics are evaluated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_minibatches</strong> (<em>scalar</em><em>, </em><em>int32</em>) – Number of training minibatches.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Training error per single epoch. If <cite>self.with_metrics</cite> is False, this is zero.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.binomial_sampling">
<span class="sig-name descname"><span class="pre">binomial_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.binomial_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.binomial_sampling" title="Link to this definition">#</a></dt>
<dd><p>Binomial sampling of hidden units activations using a rejection method.</p>
<p>Basic mechanics:</p>
<p>1) Extract a random number from a uniform distribution (g) and compare it with
the unit’s probability (pr)</p>
<p>2) Choose 0 if pr&lt;g, 1 otherwise. It is convenient to implement this condtion using
the relu function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pr</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – Input conditional probability.</p></li>
<li><p><strong>g</strong> (<em>numpy.ndarray</em><em>, </em><em>float32</em>) – Uniform probability used for comparison.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float32 tensor of sampled units. The value is 1 if pr&gt;g and 0 otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.data_pipeline">
<span class="sig-name descname"><span class="pre">data_pipeline</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.data_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.data_pipeline" title="Link to this definition">#</a></dt>
<dd><p>Define the data pipeline</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.eval_out">
<span class="sig-name descname"><span class="pre">eval_out</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.eval_out"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.eval_out" title="Link to this definition">#</a></dt>
<dd><p>Implement multinomial sampling from a trained model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit method</p>
<p>Training in generative models takes place in two steps:</p>
<ol class="arabic simple">
<li><p>Gibbs sampling</p></li>
<li><p>Gradient evaluation and parameters update</p></li>
</ol>
<p>This estimate is later used in the weight update step by minimizing the distance between the
model and the empirical free energy. Note that while the unit’s configuration space is sampled,
the weights are determined via maximum likelihood (saddle point).</p>
<p>Main component of the algo; once instantiated, it generates the computational graph and performs
model training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xtr</strong> (<em>numpy.ndarray</em><em>, </em><em>integers</em>) – the user/affinity matrix for the train set</p></li>
<li><p><strong>xtst</strong> (<em>numpy.ndarray</em><em>, </em><em>integers</em>) – the user/affinity matrix for the test set</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.free_energy">
<span class="sig-name descname"><span class="pre">free_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.free_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.free_energy" title="Link to this definition">#</a></dt>
<dd><p>Free energy of the visible units given the hidden units. Since the sum is over the hidden units’
states, the functional form of the visible units Free energy is the same as the one for the binary model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>tf.Tensor</em>) – This can be either the sampled value of the visible units (v_k) or the input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Free energy of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.generate_graph">
<span class="sig-name descname"><span class="pre">generate_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.generate_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.generate_graph" title="Link to this definition">#</a></dt>
<dd><p>Call the different RBM modules to generate the computational graph</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.gibbs_protocol">
<span class="sig-name descname"><span class="pre">gibbs_protocol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.gibbs_protocol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.gibbs_protocol" title="Link to this definition">#</a></dt>
<dd><p>Gibbs protocol.</p>
<p>Basic mechanics:</p>
<p>If the current epoch i is in the interval specified in the training protocol,
the number of steps in Gibbs sampling (k) is incremented by one and gibbs_sampling is updated
accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – Current epoch in the loop</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.gibbs_sampling">
<span class="sig-name descname"><span class="pre">gibbs_sampling</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.gibbs_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.gibbs_sampling" title="Link to this definition">#</a></dt>
<dd><p>Gibbs sampling: Determines an estimate of the model configuration via sampling. In the binary
RBM we need to impose that unseen movies stay as such, i.e. the sampling phase should not modify
the elements where v=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>scalar</em><em>, </em><em>integer</em>) – iterator. Number of sampling steps.</p></li>
<li><p><strong>v</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – visible units.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>h_k</cite>: The sampled value of the hidden unit at step k, float32.</p></li>
<li><p><cite>v_k</cite>: The sampled value of the visible unit at step k, float32.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.init_gpu">
<span class="sig-name descname"><span class="pre">init_gpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.init_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.init_gpu" title="Link to this definition">#</a></dt>
<dd><p>Config GPU memory</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.init_metrics">
<span class="sig-name descname"><span class="pre">init_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.init_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.init_metrics" title="Link to this definition">#</a></dt>
<dd><p>Initialize metrics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.init_parameters">
<span class="sig-name descname"><span class="pre">init_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.init_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.init_parameters" title="Link to this definition">#</a></dt>
<dd><p>Initialize the parameters of the model.</p>
<p>This is a single layer model with two biases. So we have a rectangular matrix w_{ij} and
two bias vectors to initialize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_visible</strong> (<em>int</em>) – number of visible units (input layer)</p></li>
<li><p><strong>n_hidden</strong> (<em>int</em>) – number of hidden units (latent variables of the model)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>w</cite> of size (n_visible, n_hidden): correlation matrix initialized by sampling from a normal distribution with zero mean and given variance init_stdv.</p></li>
<li><p><cite>bv</cite> of size (1, n_visible): visible units’ bias, initialized to zero.</p></li>
<li><p><cite>bh</cite> of size (1, n_hidden): hidden units’ bias, initiliazed to zero.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.init_training_session">
<span class="sig-name descname"><span class="pre">init_training_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.init_training_session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.init_training_session" title="Link to this definition">#</a></dt>
<dd><p>Initialize the TF session on training data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xtr</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – The user/affinity matrix for the train set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./rbm_model.ckpt'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.load" title="Link to this definition">#</a></dt>
<dd><p>Load model parameters for further use.</p>
<p>This function loads a saved tensorflow session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – file path for RBM model checkpoint</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.losses">
<span class="sig-name descname"><span class="pre">losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.losses" title="Link to this definition">#</a></dt>
<dd><p>Calculate contrastive divergence, which is the difference between
the free energy clamped on the data (v) and the model Free energy (v_k).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vv</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – empirical input</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>contrastive divergence</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.multinomial_distribution">
<span class="sig-name descname"><span class="pre">multinomial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.multinomial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.multinomial_distribution" title="Link to this definition">#</a></dt>
<dd><p>Probability that unit v has value l given phi: P(v=l|phi)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<em>tf.Tensor</em>) – linear combination of values of the previous layer</p></li>
<li><p><strong>r</strong> (<em>float</em>) – rating scale, corresponding to the number of classes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A tensor of shape (r, m, Nv): This needs to be reshaped as (m, Nv, r) in the last step to allow for faster sampling when used in the multinomial function.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.multinomial_sampling">
<span class="sig-name descname"><span class="pre">multinomial_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.multinomial_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.multinomial_sampling" title="Link to this definition">#</a></dt>
<dd><p>Multinomial Sampling of ratings</p>
<p>Basic mechanics:
For r classes, we sample r binomial distributions using the rejection method. This is possible
since each class is statistically independent from the other. Note that this is the same method
used in numpy’s random.multinomial() function.</p>
<p>1) extract a size r array of random numbers from a uniform distribution (g). As pr is normalized,
we need to normalize g as well.</p>
<p>2) For each user and item, compare pr with the reference distribution. Note that the latter needs
to be the same for ALL the user/item pairs in the dataset, as by assumptions they are sampled
from a common distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pr</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – A distributions of shape (m, n, r), where m is the number of examples, n the number
of features and r the number of classes. pr needs to be normalized, i.e. sum_k p(k) = 1 for all m, at fixed n.</p></li>
<li><p><strong>f</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – Normalized, uniform probability used for comparison.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An (m,n) float32 tensor of sampled rankings from 1 to r.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.placeholder">
<span class="sig-name descname"><span class="pre">placeholder</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.placeholder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.placeholder" title="Link to this definition">#</a></dt>
<dd><p>Initialize the placeholders for the visible units</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.predict" title="Link to this definition">#</a></dt>
<dd><p>Returns the inferred ratings. This method is similar to recommend_k_items() with the
exceptions that it returns all the inferred ratings</p>
<p>Basic mechanics:</p>
<p>The method samples new ratings from the learned joint distribution, together with
their probabilities. The input x must have the same number of columns as the one used
for training the model, i.e. the same number of items, but it can have an arbitrary number
of rows (users).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – Input user/affinity matrix. Note that this can be a single vector, i.e.</p></li>
<li><p><strong>user.</strong> (<em>the ratings</em><em> of </em><em>a single</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A matrix with the inferred ratings.</p></li>
<li><p>The elapsed time for predediction.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.recommend_k_items" title="Link to this definition">#</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.</p>
<p>Basic mechanics:</p>
<p>The method samples new ratings from the learned joint distribution, together with their
probabilities. The input x must have the same number of columns as the one used for training
the model (i.e. the same number of items) but it can have an arbitrary number of rows (users).</p>
<p>A recommendation score is evaluated by taking the element-wise product between the ratings and
the associated probabilities. For example, we could have the following situation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">rating</span>     <span class="n">probability</span>     <span class="n">score</span>
<span class="n">item1</span>     <span class="mi">5</span>           <span class="mf">0.5</span>          <span class="mf">2.5</span>
<span class="n">item2</span>     <span class="mi">4</span>           <span class="mf">0.8</span>          <span class="mf">3.2</span>
</pre></div>
</div>
<p>then item2 will be recommended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – input user/affinity matrix. Note that this can be a single vector, i.e. the ratings</p></li>
<li><p><strong>user.</strong> (<em>of a single</em>)</p></li>
<li><p><strong>top_k</strong> (<em>scalar</em><em>, </em><em>int32</em>) – the number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A sparse matrix containing the top_k elements ordered by their score.</p></li>
<li><p>The time taken to recommend k items.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.sample_hidden_units">
<span class="sig-name descname"><span class="pre">sample_hidden_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.sample_hidden_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.sample_hidden_units" title="Link to this definition">#</a></dt>
<dd><p>Sampling: In RBM we use Contrastive divergence to sample the parameter space. In order to do that we need
to initialize the two conditional probabilities:</p>
<p>P(h|phi_v) –&gt; returns the probability that the i-th hidden unit is active</p>
<p>P(v|phi_h) –&gt; returns the probability that the  i-th visible unit is active</p>
<p>Sample hidden units given the visibles. This can be thought of as a Forward pass step in a FFN</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vv</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – visible units</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>phv</cite>: The activation probability of the hidden unit.</p></li>
<li><p><cite>h_</cite>: The sampled value of the hidden unit from a Bernoulli distributions having success probability <cite>phv</cite>.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.sample_visible_units">
<span class="sig-name descname"><span class="pre">sample_visible_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.sample_visible_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.sample_visible_units" title="Link to this definition">#</a></dt>
<dd><p>Sample the visible units given the hiddens. This can be thought of as a Backward pass in a FFN
(negative phase). Each visible unit can take values in [1,rating], while the zero is reserved
for missing data; as such the value of the hidden unit is sampled from a multinomial distribution.</p>
<p>Basic mechanics:</p>
<p>1) For every training example we first sample Nv Multinomial distributions. The result is of the
form [0,1,0,0,0,…,0] where the index of the 1 element corresponds to the rth rating. The index
is extracted using the argmax function and we need to add 1 at the end since array indeces starts
from 0.</p>
<p>2) Selects only those units that have been sampled. During the training phase it is important to not
use the reconstructed inputs, so we beed to enforce a zero value in the reconstructed ratings in
the same position as the original input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>h</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – visible units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>pvh</cite>: The activation probability of the visible unit given the hidden.</p></li>
<li><p><cite>v_</cite>: The sampled value of the visible unit from a Multinomial distributions having success probability <cite>pvh</cite>.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./rbm_model.ckpt'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rbm/rbm.html#RBM.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.save" title="Link to this definition">#</a></dt>
<dd><p>Save model parameters to <cite>file_path</cite></p>
<p>This function saves the current tensorflow session to a specified path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – output file path for the RBM model checkpoint
we will create a new directory if not existing.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.sar.sar_singlenode">
<span id="sar"></span><h2>SAR<a class="headerlink" href="#module-recommenders.models.sar.sar_singlenode" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sar.sar_singlenode.</span></span><span class="sig-name descname"><span class="pre">SARSingleNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jaccard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_decay_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_now</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timedecay_formula</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode" title="Link to this definition">#</a></dt>
<dd><p>Simple Algorithm for Recommendations (SAR) implementation</p>
<p>SAR is a fast scalable adaptive algorithm for personalized recommendations based on user transaction history
and items description. The core idea behind SAR is to recommend items like those that a user already has
demonstrated an affinity to. It does this by 1) estimating the affinity of users for items, 2) estimating
similarity across items, and then 3) combining the estimates to generate a set of recommendations for a given user.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jaccard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_decay_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_now</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timedecay_formula</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col_user</strong> (<em>str</em>) – user column name</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – item column name</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – rating column name</p></li>
<li><p><strong>col_timestamp</strong> (<em>str</em>) – timestamp column name</p></li>
<li><p><strong>col_prediction</strong> (<em>str</em>) – prediction column name</p></li>
<li><p><strong>similarity_type</strong> (<em>str</em>) – [‘cooccurrence’, ‘cosine’, ‘inclusion index’, ‘jaccard’,
‘lexicographers mutual information’, ‘lift’, ‘mutual information’] option for
computing item-item similarity</p></li>
<li><p><strong>time_decay_coefficient</strong> (<em>float</em>) – number of days till ratings are decayed by 1/2</p></li>
<li><p><strong>time_now</strong> (<em>int</em><em> | </em><em>None</em>) – current time for time decay calculation</p></li>
<li><p><strong>timedecay_formula</strong> (<em>bool</em>) – flag to apply time decay</p></li>
<li><p><strong>threshold</strong> (<em>int</em>) – item-item co-occurrences below this threshold will be removed</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – option for normalizing predictions to scale of original ratings</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_affinity_matrix">
<span class="sig-name descname"><span class="pre">compute_affinity_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rating_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_affinity_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_affinity_matrix" title="Link to this definition">#</a></dt>
<dd><p>Affinity matrix.</p>
<p>The user-affinity matrix can be constructed by treating the users and items as
indices in a sparse matrix, and the events as the data. Here, we’re treating
the ratings as the event weights.  We convert between different sparse-matrix
formats to de-duplicate user-item pairs, otherwise they will get added up.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Indexed df of users and items</p></li>
<li><p><strong>rating_col</strong> (<em>str</em>) – Name of column to use for ratings</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Affinity matrix in Compressed Sparse Row (CSR) format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sparse.csr</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_cooccurrence_matrix">
<span class="sig-name descname"><span class="pre">compute_cooccurrence_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_cooccurrence_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_cooccurrence_matrix" title="Link to this definition">#</a></dt>
<dd><p>Co-occurrence matrix.</p>
<p>The co-occurrence matrix is defined as <span class="math notranslate nohighlight">\(C = U^T * U\)</span></p>
<p>where U is the user_affinity matrix with 1’s as values (instead of ratings).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame of users and items</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Co-occurrence matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_time_decay">
<span class="sig-name descname"><span class="pre">compute_time_decay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_time_decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_time_decay" title="Link to this definition">#</a></dt>
<dd><p>Compute time decay on provided column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame of users and items</p></li>
<li><p><strong>decay_column</strong> (<em>str</em>) – column to decay</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>with column decayed</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.fit" title="Link to this definition">#</a></dt>
<dd><p>Main fit method for SAR.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please make sure that <cite>df</cite> has no duplicates.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – User item rating dataframe (without duplicates).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.get_item_based_topk">
<span class="sig-name descname"><span class="pre">get_item_based_topk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.get_item_based_topk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_item_based_topk" title="Link to this definition">#</a></dt>
<dd><p>Get top K similar items to provided seed items based on similarity metric defined.
This method will take a set of items and use them to recommend the most similar items to that set
based on the similarity matrix fit during training.
This allows recommendations for cold-users (unseen during training), note - the model is not updated.</p>
<p>The following options are possible based on information provided in the items input:
1. Single user or seed of items: only item column (ratings are assumed to be 1)
2. Single user or seed of items w/ ratings: item column and rating column
3. Separate users or seeds of items: item and user column (user ids are only used to separate item sets)
4. Separate users or seeds of items with ratings: item, user and rating columns provided</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> (<em>pandas.DataFrame</em>) – DataFrame with item, user (optional), and rating (optional) columns</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sorted top k recommendation items</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.get_popularity_based_topk">
<span class="sig-name descname"><span class="pre">get_popularity_based_topk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.get_popularity_based_topk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_popularity_based_topk" title="Link to this definition">#</a></dt>
<dd><p>Get top K most frequently occurring items across all users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend.</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results.</p></li>
<li><p><strong>items</strong> (<em>bool</em>) – if false, return most frequent users instead</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>top k most popular items.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.get_topk_most_similar_users">
<span class="sig-name descname"><span class="pre">get_topk_most_similar_users</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.get_topk_most_similar_users"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_topk_most_similar_users" title="Link to this definition">#</a></dt>
<dd><p>Based on user affinity towards items, calculate the most similar users to the given user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> (<em>int</em>) – user to retrieve most similar users for</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>top k most similar users and their scores</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.predict" title="Link to this definition">#</a></dt>
<dd><p>Output SAR scores for only the users-items pairs which are in the test set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test</strong> (<em>pandas.DataFrame</em>) – DataFrame that contains users and items to test</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame contains the prediction results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.recommend_k_items" title="Link to this definition">#</a></dt>
<dd><p>Recommend top K items for all users which are in the test set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – users to test</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove items seen in training from recommendation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>top k recommendation items for each user</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.score" title="Link to this definition">#</a></dt>
<dd><p>Score all items for test users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – user to test</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove items seen in training from recommendation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of interest of all items for the users.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.set_index">
<span class="sig-name descname"><span class="pre">set_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.set_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.set_index" title="Link to this definition">#</a></dt>
<dd><p>Generate continuous indices for users and items to reduce memory usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – dataframe with user and item ids</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.sasrec.model">
<span id="sasrec"></span><h2>SASRec<a class="headerlink" href="#module-recommenders.models.sasrec.model" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.Encoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.model.</span></span><span class="sig-name descname"><span class="pre">Encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#Encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.Encoder" title="Link to this definition">#</a></dt>
<dd><p>Invokes Transformer based encoder with user defined number of layers</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.Encoder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_max_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#Encoder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.Encoder.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_layers</strong> (<em>int</em>) – Number of layers.</p></li>
<li><p><strong>seq_max_len</strong> (<em>int</em>) – Maximum sequence length.</p></li>
<li><p><strong>embedding_dim</strong> (<em>int</em>) – Embedding dimension.</p></li>
<li><p><strong>attention_dim</strong> (<em>int</em>) – Dimension of the attention embeddings.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of heads in the multi-head self-attention module.</p></li>
<li><p><strong>conv_dims</strong> (<em>list</em>) – List of the dimensions of the Feedforward layer.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – Dropout probability.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.Encoder.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#Encoder.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.Encoder.call" title="Link to this definition">#</a></dt>
<dd><p>Model forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tf.Tensor</em>) – Input tensor.</p></li>
<li><p><strong>training</strong> (<em>Boolean</em>) – True if in training mode.</p></li>
<li><p><strong>mask</strong> (<em>tf.Tensor</em>) – Mask tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.EncoderLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.model.</span></span><span class="sig-name descname"><span class="pre">EncoderLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#EncoderLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.EncoderLayer" title="Link to this definition">#</a></dt>
<dd><p>Transformer based encoder layer</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.EncoderLayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_max_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#EncoderLayer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.EncoderLayer.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_max_len</strong> (<em>int</em>) – Maximum sequence length.</p></li>
<li><p><strong>embedding_dim</strong> (<em>int</em>) – Embedding dimension.</p></li>
<li><p><strong>attention_dim</strong> (<em>int</em>) – Dimension of the attention embeddings.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of heads in the multi-head self-attention module.</p></li>
<li><p><strong>conv_dims</strong> (<em>list</em>) – List of the dimensions of the Feedforward layer.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – Dropout probability.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.EncoderLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#EncoderLayer.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.EncoderLayer.call" title="Link to this definition">#</a></dt>
<dd><p>Model forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tf.Tensor</em>) – Input tensor.</p></li>
<li><p><strong>training</strong> (<em>Boolean</em>) – True if in training mode.</p></li>
<li><p><strong>mask</strong> (<em>tf.Tensor</em>) – Mask tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.EncoderLayer.call_">
<span class="sig-name descname"><span class="pre">call_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#EncoderLayer.call_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.EncoderLayer.call_" title="Link to this definition">#</a></dt>
<dd><p>Model forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tf.Tensor</em>) – Input tensor.</p></li>
<li><p><strong>training</strong> (<em>tf.Tensor</em>) – Training tensor.</p></li>
<li><p><strong>mask</strong> (<em>tf.Tensor</em>) – Mask tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.LayerNormalization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.model.</span></span><span class="sig-name descname"><span class="pre">LayerNormalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#LayerNormalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.LayerNormalization" title="Link to this definition">#</a></dt>
<dd><p>Layer normalization using mean and variance
gamma and beta are the learnable parameters</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.LayerNormalization.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_max_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#LayerNormalization.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.LayerNormalization.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_max_len</strong> (<em>int</em>) – Maximum sequence length.</p></li>
<li><p><strong>embedding_dim</strong> (<em>int</em>) – Embedding dimension.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – Epsilon value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.LayerNormalization.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#LayerNormalization.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.LayerNormalization.call" title="Link to this definition">#</a></dt>
<dd><p>Model forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>tf.Tensor</em>) – Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.MultiHeadAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.model.</span></span><span class="sig-name descname"><span class="pre">MultiHeadAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#MultiHeadAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.MultiHeadAttention" title="Link to this definition">#</a></dt>
<dd><ul class="simple">
<li><p>Q (query), K (key) and V (value) are split into multiple heads (num_heads)</p></li>
<li><p>each tuple (q, k, v) are fed to scaled_dot_product_attention</p></li>
<li><p>all attention outputs are concatenated</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.MultiHeadAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attention_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#MultiHeadAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.MultiHeadAttention.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attention_dim</strong> (<em>int</em>) – Dimension of the attention embeddings.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of heads in the multi-head self-attention module.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – Dropout probability.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.MultiHeadAttention.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#MultiHeadAttention.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.MultiHeadAttention.call" title="Link to this definition">#</a></dt>
<dd><p>Model forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queries</strong> (<em>tf.Tensor</em>) – Tensor of queries.</p></li>
<li><p><strong>keys</strong> (<em>tf.Tensor</em>) – Tensor of keys</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.PointWiseFeedForward">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.model.</span></span><span class="sig-name descname"><span class="pre">PointWiseFeedForward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#PointWiseFeedForward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.PointWiseFeedForward" title="Link to this definition">#</a></dt>
<dd><p>Convolution layers with residual connection</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.PointWiseFeedForward.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#PointWiseFeedForward.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.PointWiseFeedForward.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conv_dims</strong> (<em>list</em>) – List of the dimensions of the Feedforward layer.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – Dropout probability.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.PointWiseFeedForward.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#PointWiseFeedForward.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.PointWiseFeedForward.call" title="Link to this definition">#</a></dt>
<dd><p>Model forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>tf.Tensor</em>) – Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.model.</span></span><span class="sig-name descname"><span class="pre">SASREC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC" title="Link to this definition">#</a></dt>
<dd><p>SAS Rec model
Self-Attentive Sequential Recommendation Using Transformer</p>
<dl class="field-list">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Wang-Cheng Kang, Julian McAuley (2018), Self-Attentive Sequential
Recommendation. Proceedings of IEEE International Conference on
Data Mining (ICDM’18)</p>
<p>Original source code from nnkkmto/SASRec-tf2,
<a class="github reference external" href="https://github.com/nnkkmto/SASRec-tf2">nnkkmto/SASRec-tf2</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.__init__" title="Link to this definition">#</a></dt>
<dd><p>Model initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item_num</strong> (<em>int</em>) – Number of items in the dataset.</p></li>
<li><p><strong>seq_max_len</strong> (<em>int</em>) – Maximum number of items in user history.</p></li>
<li><p><strong>num_blocks</strong> (<em>int</em>) – Number of Transformer blocks to be used.</p></li>
<li><p><strong>embedding_dim</strong> (<em>int</em>) – Item embedding dimension.</p></li>
<li><p><strong>attention_dim</strong> (<em>int</em>) – Transformer attention dimension.</p></li>
<li><p><strong>conv_dims</strong> (<em>list</em>) – List of the dimensions of the Feedforward layer.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – Dropout rate.</p></li>
<li><p><strong>l2_reg</strong> (<em>float</em>) – Coefficient of the L2 regularization.</p></li>
<li><p><strong>num_neg_test</strong> (<em>int</em>) – Number of negative examples used in testing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.call" title="Link to this definition">#</a></dt>
<dd><p>Model forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tf.Tensor</em>) – Input tensor.</p></li>
<li><p><strong>training</strong> (<em>tf.Tensor</em>) – Training tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Logits of the positive examples.</p></li>
<li><p>Logits of the negative examples.</p></li>
<li><p>Mask for nonzero targets</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.create_combined_dataset">
<span class="sig-name descname"><span class="pre">create_combined_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.create_combined_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.create_combined_dataset" title="Link to this definition">#</a></dt>
<dd><p>function to create model inputs from sampled batch data.
This function is used only during training.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.embedding">
<span class="sig-name descname"><span class="pre">embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_seq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.embedding" title="Link to this definition">#</a></dt>
<dd><p>Compute the sequence and positional embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_seq</strong> (<em>tf.Tensor</em>) – Input sequence</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Sequence embeddings.</p></li>
<li><p>Positional embeddings.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluation on the test users (users with at least 3 items)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.evaluate_valid">
<span class="sig-name descname"><span class="pre">evaluate_valid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.evaluate_valid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.evaluate_valid" title="Link to this definition">#</a></dt>
<dd><p>Evaluation on the validation users</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istarget</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.loss_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.loss_function" title="Link to this definition">#</a></dt>
<dd><p>Losses are calculated separately for the positive and negative
items based on the corresponding logits. A mask is included to
take care of the zero items (added for padding).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_logits</strong> (<em>tf.Tensor</em>) – Logits of the positive examples.</p></li>
<li><p><strong>neg_logits</strong> (<em>tf.Tensor</em>) – Logits of the negative examples.</p></li>
<li><p><strong>istarget</strong> (<em>tf.Tensor</em>) – Mask for nonzero targets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.predict" title="Link to this definition">#</a></dt>
<dd><p>Returns the logits for the test items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>tf.Tensor</em>) – Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.model.SASREC.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/model.html#SASREC.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.model.SASREC.train" title="Link to this definition">#</a></dt>
<dd><p>High level function for model training as well as
evaluation on the validation and test dataset</p>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-recommenders.models.sasrec.sampler">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.sampler.</span></span><span class="sig-name descname"><span class="pre">WarpSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">User</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usernum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemnum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/sampler.html#WarpSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler" title="Link to this definition">#</a></dt>
<dd><p>Sampler object that creates an iterator for feeding batch data while training.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.User">
<span class="sig-name descname"><span class="pre">User</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.User" title="Link to this definition">#</a></dt>
<dd><p>dict, all the users (keys) with items as values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.usernum">
<span class="sig-name descname"><span class="pre">usernum</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.usernum" title="Link to this definition">#</a></dt>
<dd><p>integer, total number of users</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.itemnum">
<span class="sig-name descname"><span class="pre">itemnum</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.itemnum" title="Link to this definition">#</a></dt>
<dd><p>integer, total number of items</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.batch_size" title="Link to this definition">#</a></dt>
<dd><p>batch size</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.maxlen">
<span class="sig-name descname"><span class="pre">maxlen</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.maxlen" title="Link to this definition">#</a></dt>
<dd><p>maximum input sequence length</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.n_workers">
<span class="sig-name descname"><span class="pre">n_workers</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.n_workers" title="Link to this definition">#</a></dt>
<dd><p>number of workers for parallel execution</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">User</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usernum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemnum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/sampler.html#WarpSampler.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.sample_function">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.sampler.</span></span><span class="sig-name descname"><span class="pre">sample_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usernum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemnum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_queue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/sampler.html#sample_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.sampler.sample_function" title="Link to this definition">#</a></dt>
<dd><p>Batch sampler that creates a sequence of negative items based on the
original sequence of items (positive) that the user has interacted with.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_train</strong> (<em>dict</em>) – dictionary of training exampled for each user</p></li>
<li><p><strong>usernum</strong> (<em>int</em>) – number of users</p></li>
<li><p><strong>itemnum</strong> (<em>int</em>) – number of items</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size</p></li>
<li><p><strong>maxlen</strong> (<em>int</em>) – maximum input sequence length</p></li>
<li><p><strong>result_queue</strong> (<em>multiprocessing.Queue</em>) – queue for storing sample results</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – seed for random generator</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-recommenders.models.sasrec.util">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.util.</span></span><span class="sig-name descname"><span class="pre">SASRecDataSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/util.html#SASRecDataSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet" title="Link to this definition">#</a></dt>
<dd><p>A class for creating SASRec specific dataset used during
train, validation and testing.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.usernum">
<span class="sig-name descname"><span class="pre">usernum</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.usernum" title="Link to this definition">#</a></dt>
<dd><p>integer, total number of users</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.itemnum">
<span class="sig-name descname"><span class="pre">itemnum</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.itemnum" title="Link to this definition">#</a></dt>
<dd><p>integer, total number of items</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.User">
<span class="sig-name descname"><span class="pre">User</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.User" title="Link to this definition">#</a></dt>
<dd><p>dict, all the users (keys) with items as values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.Items">
<span class="sig-name descname"><span class="pre">Items</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.Items" title="Link to this definition">#</a></dt>
<dd><p>set of all the items</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.user_train">
<span class="sig-name descname"><span class="pre">user_train</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.user_train" title="Link to this definition">#</a></dt>
<dd><p>dict, subset of User that are used for training</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.user_valid">
<span class="sig-name descname"><span class="pre">user_valid</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.user_valid" title="Link to this definition">#</a></dt>
<dd><p>dict, subset of User that are used for validation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.user_test">
<span class="sig-name descname"><span class="pre">user_test</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.user_test" title="Link to this definition">#</a></dt>
<dd><p>dict, subset of User that are used for testing</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.col_sep">
<span class="sig-name descname"><span class="pre">col_sep</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.col_sep" title="Link to this definition">#</a></dt>
<dd><p>column separator in the data file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.filename">
<span class="sig-name descname"><span class="pre">filename</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.filename" title="Link to this definition">#</a></dt>
<dd><p>data filename</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.sasrec.ssept">
<span id="sse-pt"></span><h2>SSE-PT<a class="headerlink" href="#module-recommenders.models.sasrec.ssept" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.ssept.SSEPT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.ssept.</span></span><span class="sig-name descname"><span class="pre">SSEPT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/ssept.html#SSEPT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.ssept.SSEPT" title="Link to this definition">#</a></dt>
<dd><p>SSE-PT Model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Wu L., Li S., Hsieh C-J., Sharpnack J., SSE-PT: Sequential Recommendation
Via Personalized Transformer, RecSys, 2020.
TF 1.x codebase: <a class="github reference external" href="https://github.com/SSE-PT/SSE-PT">SSE-PT/SSE-PT</a>
TF 2.x codebase (SASREc): <a class="github reference external" href="https://github.com/nnkkmto/SASRec-tf2">nnkkmto/SASRec-tf2</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.ssept.SSEPT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/ssept.html#SSEPT.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.ssept.SSEPT.__init__" title="Link to this definition">#</a></dt>
<dd><p>Model initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item_num</strong> (<em>int</em>) – Number of items in the dataset.</p></li>
<li><p><strong>seq_max_len</strong> (<em>int</em>) – Maximum number of items in user history.</p></li>
<li><p><strong>num_blocks</strong> (<em>int</em>) – Number of Transformer blocks to be used.</p></li>
<li><p><strong>embedding_dim</strong> (<em>int</em>) – Item embedding dimension.</p></li>
<li><p><strong>attention_dim</strong> (<em>int</em>) – Transformer attention dimension.</p></li>
<li><p><strong>conv_dims</strong> (<em>list</em>) – List of the dimensions of the Feedforward layer.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – Dropout rate.</p></li>
<li><p><strong>l2_reg</strong> (<em>float</em>) – Coefficient of the L2 regularization.</p></li>
<li><p><strong>num_neg_test</strong> (<em>int</em>) – Number of negative examples used in testing.</p></li>
<li><p><strong>user_num</strong> (<em>int</em>) – Number of users in the dataset.</p></li>
<li><p><strong>user_embedding_dim</strong> (<em>int</em>) – User embedding dimension.</p></li>
<li><p><strong>item_embedding_dim</strong> (<em>int</em>) – Item embedding dimension.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.ssept.SSEPT.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/ssept.html#SSEPT.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.ssept.SSEPT.call" title="Link to this definition">#</a></dt>
<dd><p>Model forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tf.Tensor</em>) – Input tensor.</p></li>
<li><p><strong>training</strong> (<em>tf.Tensor</em>) – Training tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Logits of the positive examples.</p></li>
<li><p>Logits of the negative examples.</p></li>
<li><p>Mask for nonzero targets</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.ssept.SSEPT.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istarget</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/ssept.html#SSEPT.loss_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.ssept.SSEPT.loss_function" title="Link to this definition">#</a></dt>
<dd><p>Losses are calculated separately for the positive and negative
items based on the corresponding logits. A mask is included to
take care of the zero items (added for padding).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_logits</strong> (<em>tf.Tensor</em>) – Logits of the positive examples.</p></li>
<li><p><strong>neg_logits</strong> (<em>tf.Tensor</em>) – Logits of the negative examples.</p></li>
<li><p><strong>istarget</strong> (<em>tf.Tensor</em>) – Mask for nonzero targets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sasrec.ssept.SSEPT.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/ssept.html#SSEPT.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.ssept.SSEPT.predict" title="Link to this definition">#</a></dt>
<dd><p>Model prediction for candidate (negative) items</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.surprise.surprise_utils">
<span id="surprise-utilities"></span><h2>Surprise utilities<a class="headerlink" href="#module-recommenders.models.surprise.surprise_utils" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.compute_ranking_predictions">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">compute_ranking_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/surprise/surprise_utils.html#compute_ranking_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.compute_ranking_predictions" title="Link to this definition">#</a></dt>
<dd><p>Computes predictions of an algorithm from Surprise on all users and items in data. It can be used for computing
ranking metrics like NDCG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algo</strong> (<em>surprise.prediction_algorithms.algo_base.AlgoBase</em>) – an algorithm from Surprise</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – the data from which to get the users and items</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – name of the item column</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove (user, item) pairs seen in the training data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.predict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/surprise/surprise_utils.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.predict" title="Link to this definition">#</a></dt>
<dd><p>Computes predictions of an algorithm from Surprise on the data. Can be used for computing rating metrics like RMSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algo</strong> (<em>surprise.prediction_algorithms.algo_base.AlgoBase</em>) – an algorithm from Surprise</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – the data on which to predict</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – name of the item column</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.surprise_trainset_to_df">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">surprise_trainset_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/surprise/surprise_utils.html#surprise_trainset_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.surprise_trainset_to_df" title="Link to this definition">#</a></dt>
<dd><p>Converts a <cite>surprise.Trainset</cite> object to <cite>pandas.DataFrame</cite></p>
<p>More info: <a class="reference external" href="https://surprise.readthedocs.io/en/stable/trainset.html">https://surprise.readthedocs.io/en/stable/trainset.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainset</strong> (<em>object</em>) – A surprise.Trainset object.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe with user column (str), item column (str), and rating column (float).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.tfidf.tfidf_utils">
<span id="tf-idf-utilities"></span><h2>TF-IDF utilities<a class="headerlink" href="#module-recommenders.models.tfidf.tfidf_utils" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.tfidf.tfidf_utils.</span></span><span class="sig-name descname"><span class="pre">TfidfRecommender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenization_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scibert'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender" title="Link to this definition">#</a></dt>
<dd><p>Term Frequency - Inverse Document Frequency (TF-IDF) Recommender</p>
<p>This class provides content-based recommendations using TF-IDF vectorization in combination with cosine similarity.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.clean_dataframe">
<span class="sig-name descname"><span class="pre">clean_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols_to_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cleaned_text'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.clean_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.clean_dataframe" title="Link to this definition">#</a></dt>
<dd><p>Clean the text within the columns of interest and return a dataframe with cleaned and combined text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe containing the text content to clean.</p></li>
<li><p><strong>cols_to_clean</strong> (<em>list</em><em> of </em><em>str</em>) – List of columns to clean by name (e.g., [‘abstract’,’full_text’]).</p></li>
<li><p><strong>new_col_name</strong> (<em>str</em>) – Name of the new column that will contain the cleaned text.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with cleaned text in the new column.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors_tokenized</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit TF-IDF vectorizer to the cleaned and tokenized text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf</strong> (<em>TfidfVectorizer</em>) – sklearn.feature_extraction.text.TfidfVectorizer object defined in .tokenize_text().</p></li>
<li><p><strong>vectors_tokenized</strong> (<em>pandas.Series</em>) – Each row contains tokens for respective documents separated by spaces.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_stop_words">
<span class="sig-name descname"><span class="pre">get_stop_words</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_stop_words"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_stop_words" title="Link to this definition">#</a></dt>
<dd><p>Return the stop words excluded in the TF-IDF vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Frozenset of stop words used by the TF-IDF vectorizer (can be converted to list).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_tokens">
<span class="sig-name descname"><span class="pre">get_tokens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_tokens" title="Link to this definition">#</a></dt>
<dd><p>Return the tokens generated by the TF-IDF vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of tokens generated by the TF-IDF vectorizer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_top_k_recommendations">
<span class="sig-name descname"><span class="pre">get_top_k_recommendations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols_to_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_top_k_recommendations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_top_k_recommendations" title="Link to this definition">#</a></dt>
<dd><p>Return the top k recommendations with useful metadata for each recommendation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> (<em>pandas.DataFrame</em>) – Dataframe holding metadata for all public domain papers.</p></li>
<li><p><strong>query_id</strong> (<em>str</em>) – ID of item of interest.</p></li>
<li><p><strong>cols_to_keep</strong> (<em>list</em><em> of </em><em>str</em>) – List of columns from the metadata dataframe to include
(e.g., [‘title’,’authors’,’journal’,’publish_time’,’url’]).
By default, all columns are kept.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Set to True if you want to print the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stylized dataframe holding recommendations and associated metadata just for the item of interest (can access as normal dataframe by using df.data).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.Styler</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.recommend_top_k_items">
<span class="sig-name descname"><span class="pre">recommend_top_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.recommend_top_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.recommend_top_k_items" title="Link to this definition">#</a></dt>
<dd><p>Recommend k number of items similar to the item of interest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_clean</strong> (<em>pandas.DataFrame</em>) – Dataframe with cleaned text.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of recommendations to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe containing id of top k recommendations for all items.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.tokenize_text">
<span class="sig-name descname"><span class="pre">tokenize_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cleaned_text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.tokenize_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.tokenize_text" title="Link to this definition">#</a></dt>
<dd><p>Tokenize the input text.
For more details on the TfidfVectorizer, see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_clean</strong> (<em>pandas.DataFrame</em>) – Dataframe with cleaned text in the new column.</p></li>
<li><p><strong>text_col</strong> (<em>str</em>) – Name of column containing the cleaned text.</p></li>
<li><p><strong>ngram_range</strong> (<em>tuple</em><em> of </em><em>int</em>) – The lower and upper boundary of the range of n-values for different n-grams to be extracted.</p></li>
<li><p><strong>min_df</strong> (<em>float</em>) – When building the vocabulary ignore terms that have a document frequency strictly lower than the given threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Scikit-learn TfidfVectorizer object defined in <cite>.tokenize_text()</cite>.</p></li>
<li><p>Each row contains tokens for respective documents separated by spaces.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TfidfVectorizer, pandas.Series</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.vae.standard_vae">
<span id="standard-vae"></span><h2>Standard VAE<a class="headerlink" href="#module-recommenders.models.vae.standard_vae" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.standard_vae.</span></span><span class="sig-name descname"><span class="pre">AnnealingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_anneal_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback" title="Link to this definition">#</a></dt>
<dd><p>This class is used for updating the value of β during the annealing process.
When β reaches the value of anneal_cap, it stops increasing.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_anneal_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>float</em>) – current value of beta.</p></li>
<li><p><strong>anneal_cap</strong> (<em>float</em>) – maximum value that beta can reach.</p></li>
<li><p><strong>total_anneal_steps</strong> (<em>int</em>) – total number of annealing steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.get_data" title="Link to this definition">#</a></dt>
<dd><p>Returns a list of the beta values per epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.on_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_batch_end" title="Link to this definition">#</a></dt>
<dd><p>At the end of each batch the beta should is updated until it reaches the values of anneal cap.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_epoch_end" title="Link to this definition">#</a></dt>
<dd><p>At the end of each epoch save the value of beta in _beta list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_train_begin" title="Link to this definition">#</a></dt>
<dd><p>Initialise a list in which the beta value will be saved at the end of each epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.LossHistory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.standard_vae.</span></span><span class="sig-name descname"><span class="pre">LossHistory</span></span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#LossHistory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.LossHistory" title="Link to this definition">#</a></dt>
<dd><p>This class is used for saving the validation loss and the training loss per epoch.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.LossHistory.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#LossHistory.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.LossHistory.on_epoch_end" title="Link to this definition">#</a></dt>
<dd><p>Save the loss of training and validation set at the end of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.LossHistory.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#LossHistory.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.LossHistory.on_train_begin" title="Link to this definition">#</a></dt>
<dd><p>Initialise the lists where the loss of training and validation will be saved.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.standard_vae.</span></span><span class="sig-name descname"><span class="pre">Metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#Metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics" title="Link to this definition">#</a></dt>
<dd><p>Callback function used to calculate the NDCG&#64;k metric of validation set at the end of each epoch.
Weights of the model with the highest NDCG&#64;k value is saved.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#Metrics.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the class parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – trained model for validation.</p></li>
<li><p><strong>val_tr</strong> (<em>numpy.ndarray</em><em>, </em><em>float</em>) – the click matrix for the validation set training part.</p></li>
<li><p><strong>val_te</strong> (<em>numpy.ndarray</em><em>, </em><em>float</em>) – the click matrix for the validation set testing part.</p></li>
<li><p><strong>mapper</strong> (<a class="reference internal" href="datasets.html#recommenders.datasets.sparse.AffinityMatrix" title="recommenders.datasets.sparse.AffinityMatrix"><em>AffinityMatrix</em></a>) – the mapper for converting click matrix to dataframe.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of top k items per user (optional).</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – Default path to save weights.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#Metrics.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.get_data" title="Link to this definition">#</a></dt>
<dd><p>Returns a list of the NDCG&#64;k of the validation set metrics calculated
at the end of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#Metrics.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.on_epoch_end" title="Link to this definition">#</a></dt>
<dd><p>At the end of each epoch calculate NDCG&#64;k of the validation set.
If the model performance is improved, the model weights are saved.
Update the list of validation NDCG&#64;k by adding obtained value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#Metrics.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.on_train_begin" title="Link to this definition">#</a></dt>
<dd><p>Initialise the list for validation NDCG&#64;k.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#Metrics.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.recommend_k_items" title="Link to this definition">#</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.
Obtained probabilities are used as recommendation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – input click matrix.</p></li>
<li><p><strong>k</strong> (<em>scalar</em><em>, </em><em>int32</em>) – the number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sparse matrix containing the top_k elements ordered by their score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.standard_vae.</span></span><span class="sig-name descname"><span class="pre">StandardVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#StandardVAE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE" title="Link to this definition">#</a></dt>
<dd><p>Standard Variational Autoencoders (VAE) for Collaborative Filtering implementation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#StandardVAE.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize class parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_users</strong> (<em>int</em>) – Number of unique users in the train set.</p></li>
<li><p><strong>original_dim</strong> (<em>int</em>) – Number of unique items in the train set.</p></li>
<li><p><strong>intermediate_dim</strong> (<em>int</em>) – Dimension of intermediate space.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Dimension of latent space.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Number of epochs for training.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of top k items per user.</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – Whether to show the training output or not.</p></li>
<li><p><strong>drop_encoder</strong> (<em>float</em>) – Dropout percentage of the encoder.</p></li>
<li><p><strong>drop_decoder</strong> (<em>float</em>) – Dropout percentage of the decoder.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – a constant parameter β in the ELBO function,
when you are not using annealing (annealing=False)</p></li>
<li><p><strong>annealing</strong> (<em>bool</em>) – option of using annealing method for training the model (True)
or not using annealing, keeping a constant beta (False)</p></li>
<li><p><strong>anneal_cap</strong> (<em>float</em>) – maximum value that beta can take during annealing process.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – Default path to save weights.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.display_metrics">
<span class="sig-name descname"><span class="pre">display_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#StandardVAE.display_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.display_metrics" title="Link to this definition">#</a></dt>
<dd><p>Plots:
1) Loss per epoch both for validation and train sets
2) NDCG&#64;k per epoch of the validation set</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#StandardVAE.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit model with the train sets and validate on the validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_train</strong> (<em>numpy.ndarray</em>) – The click matrix for the train set.</p></li>
<li><p><strong>x_valid</strong> (<em>numpy.ndarray</em>) – The click matrix for the validation set.</p></li>
<li><p><strong>x_val_tr</strong> (<em>numpy.ndarray</em>) – The click matrix for the validation set training part.</p></li>
<li><p><strong>x_val_te</strong> (<em>numpy.ndarray</em>) – The click matrix for the validation set testing part.</p></li>
<li><p><strong>mapper</strong> (<em>object</em>) – The mapper for converting click matrix to dataframe. It can be AffinityMatrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.get_optimal_beta">
<span class="sig-name descname"><span class="pre">get_optimal_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#StandardVAE.get_optimal_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.get_optimal_beta" title="Link to this definition">#</a></dt>
<dd><p>Returns the value of the optimal beta.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.ndcg_per_epoch">
<span class="sig-name descname"><span class="pre">ndcg_per_epoch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#StandardVAE.ndcg_per_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.ndcg_per_epoch" title="Link to this definition">#</a></dt>
<dd><p>Returns the list of NDCG&#64;k at each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.nn_batch_generator">
<span class="sig-name descname"><span class="pre">nn_batch_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#StandardVAE.nn_batch_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.nn_batch_generator" title="Link to this definition">#</a></dt>
<dd><p>Used for splitting dataset in batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_train</strong> (<em>numpy.ndarray</em>) – The click matrix for the train set with float values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/standard_vae.html#StandardVAE.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.recommend_k_items" title="Link to this definition">#</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.</p>
<p>Obtained probabilities are used as recommendation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Input click matrix, with <cite>int32</cite> values.</p></li>
<li><p><strong>k</strong> (<em>scalar</em>) – The number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sparse matrix containing the top_k elements ordered by their score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.vae.multinomial_vae">
<span id="multinomial-vae"></span><h2>Multinomial VAE<a class="headerlink" href="#module-recommenders.models.vae.multinomial_vae" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.multinomial_vae.</span></span><span class="sig-name descname"><span class="pre">AnnealingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_anneal_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback" title="Link to this definition">#</a></dt>
<dd><p>This class is used for updating the value of β during the annealing process.
When β reaches the value of anneal_cap, it stops increasing.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_anneal_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>float</em>) – current value of beta.</p></li>
<li><p><strong>anneal_cap</strong> (<em>float</em>) – maximum value that beta can reach.</p></li>
<li><p><strong>total_anneal_steps</strong> (<em>int</em>) – total number of annealing steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.get_data" title="Link to this definition">#</a></dt>
<dd><p>Returns a list of the beta values per epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.on_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_batch_end" title="Link to this definition">#</a></dt>
<dd><p>At the end of each batch the beta should is updated until it reaches the values of anneal cap.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_epoch_end" title="Link to this definition">#</a></dt>
<dd><p>At the end of each epoch save the value of beta in _beta list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_train_begin" title="Link to this definition">#</a></dt>
<dd><p>Initialise a list in which the beta value will be saved at the end of each epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.LossHistory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.multinomial_vae.</span></span><span class="sig-name descname"><span class="pre">LossHistory</span></span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#LossHistory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.LossHistory" title="Link to this definition">#</a></dt>
<dd><p>This class is used for saving the validation loss and the training loss per epoch.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.LossHistory.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#LossHistory.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.LossHistory.on_epoch_end" title="Link to this definition">#</a></dt>
<dd><p>Save the loss of training and validation set at the end of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.LossHistory.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#LossHistory.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.LossHistory.on_train_begin" title="Link to this definition">#</a></dt>
<dd><p>Initialise the lists where the loss of training and validation will be saved.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.multinomial_vae.</span></span><span class="sig-name descname"><span class="pre">Metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics" title="Link to this definition">#</a></dt>
<dd><p>Callback function used to calculate the NDCG&#64;k metric of validation set at the end of each epoch.
Weights of the model with the highest NDCG&#64;k value is saved.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Metrics.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the class parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – trained model for validation.</p></li>
<li><p><strong>val_tr</strong> (<em>numpy.ndarray</em><em>, </em><em>float</em>) – the click matrix for the validation set training part.</p></li>
<li><p><strong>val_te</strong> (<em>numpy.ndarray</em><em>, </em><em>float</em>) – the click matrix for the validation set testing part.</p></li>
<li><p><strong>mapper</strong> (<a class="reference internal" href="datasets.html#recommenders.datasets.sparse.AffinityMatrix" title="recommenders.datasets.sparse.AffinityMatrix"><em>AffinityMatrix</em></a>) – the mapper for converting click matrix to dataframe.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of top k items per user (optional).</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – Default path to save weights.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Metrics.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.get_data" title="Link to this definition">#</a></dt>
<dd><p>Returns a list of the NDCG&#64;k of the validation set metrics calculated
at the end of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Metrics.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.on_epoch_end" title="Link to this definition">#</a></dt>
<dd><p>At the end of each epoch calculate NDCG&#64;k of the validation set.</p>
<p>If the model performance is improved, the model weights are saved.
Update the list of validation NDCG&#64;k by adding obtained value</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Metrics.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.on_train_begin" title="Link to this definition">#</a></dt>
<dd><p>Initialise the list for validation NDCG&#64;k.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Metrics.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.recommend_k_items" title="Link to this definition">#</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.
Obtained probabilities are used as recommendation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – input click matrix.</p></li>
<li><p><strong>k</strong> (<em>scalar</em><em>, </em><em>int32</em>) – the number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sparse matrix containing the top_k elements ordered by their score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.multinomial_vae.</span></span><span class="sig-name descname"><span class="pre">Mult_VAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE" title="Link to this definition">#</a></dt>
<dd><p>Multinomial Variational Autoencoders (Multi-VAE) for Collaborative Filtering implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Citation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Liang, Dawen, et al. “Variational autoencoders for collaborative filtering.”
Proceedings of the 2018 World Wide Web Conference. 2018.
<a class="reference external" href="https://arxiv.org/pdf/1802.05814.pdf">https://arxiv.org/pdf/1802.05814.pdf</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_users</strong> (<em>int</em>) – Number of unique users in the train set.</p></li>
<li><p><strong>original_dim</strong> (<em>int</em>) – Number of unique items in the train set.</p></li>
<li><p><strong>intermediate_dim</strong> (<em>int</em>) – Dimension of intermediate space.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Dimension of latent space.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Number of epochs for training.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of top k items per user.</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – Whether to show the training output or not.</p></li>
<li><p><strong>drop_encoder</strong> (<em>float</em>) – Dropout percentage of the encoder.</p></li>
<li><p><strong>drop_decoder</strong> (<em>float</em>) – Dropout percentage of the decoder.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – a constant parameter β in the ELBO function,
when you are not using annealing (annealing=False)</p></li>
<li><p><strong>annealing</strong> (<em>bool</em>) – option of using annealing method for training the model (True)
or not using annealing, keeping a constant beta (False)</p></li>
<li><p><strong>anneal_cap</strong> (<em>float</em>) – maximum value that beta can take during annealing process.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – Default path to save weights.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.display_metrics">
<span class="sig-name descname"><span class="pre">display_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.display_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.display_metrics" title="Link to this definition">#</a></dt>
<dd><p>Plots:
1) Loss per epoch both for validation and train set
2) NDCG&#64;k per epoch of the validation set</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit model with the train sets and validate on the validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_train</strong> (<em>numpy.ndarray</em>) – the click matrix for the train set.</p></li>
<li><p><strong>x_valid</strong> (<em>numpy.ndarray</em>) – the click matrix for the validation set.</p></li>
<li><p><strong>x_val_tr</strong> (<em>numpy.ndarray</em>) – the click matrix for the validation set training part.</p></li>
<li><p><strong>x_val_te</strong> (<em>numpy.ndarray</em>) – the click matrix for the validation set testing part.</p></li>
<li><p><strong>mapper</strong> (<em>object</em>) – the mapper for converting click matrix to dataframe. It can be AffinityMatrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.get_optimal_beta">
<span class="sig-name descname"><span class="pre">get_optimal_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.get_optimal_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.get_optimal_beta" title="Link to this definition">#</a></dt>
<dd><p>Returns the value of the optimal beta.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.ndcg_per_epoch">
<span class="sig-name descname"><span class="pre">ndcg_per_epoch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.ndcg_per_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.ndcg_per_epoch" title="Link to this definition">#</a></dt>
<dd><p>Returns the list of NDCG&#64;k at each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.nn_batch_generator">
<span class="sig-name descname"><span class="pre">nn_batch_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.nn_batch_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.nn_batch_generator" title="Link to this definition">#</a></dt>
<dd><p>Used for splitting dataset in batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_train</strong> (<em>numpy.ndarray</em>) – The click matrix for the train set, with float values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.recommend_k_items" title="Link to this definition">#</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.
Obtained probabilities are used as recommendation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – input click matrix.</p></li>
<li><p><strong>k</strong> (<em>scalar</em><em>, </em><em>int32</em>) – the number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sparse matrix containing the top_k elements ordered by their score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.vowpal_wabbit.vw">
<span id="vowpal-wabbit-utilities"></span><h2>Vowpal Wabbit utilities<a class="headerlink" href="#module-recommenders.models.vowpal_wabbit.vw" title="Link to this heading">#</a></h2>
<p>This file provides a wrapper to run Vowpal Wabbit from the command line through python.
It is not recommended to use this approach in production, there are python bindings that can be installed from the
repository or pip or the command line can be used. This is merely to demonstrate vw usage in the example notebooks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vowpal_wabbit.vw.</span></span><span class="sig-name descname"><span class="pre">VW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW" title="Link to this definition">#</a></dt>
<dd><p>Vowpal Wabbit Class</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.fit" title="Link to this definition">#</a></dt>
<dd><p>Train model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input training data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.parse_test_params">
<span class="sig-name descname"><span class="pre">parse_test_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.parse_test_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.parse_test_params" title="Link to this definition">#</a></dt>
<dd><p>Parse input hyper-parameters to build vw test commands</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>dict</em>) – key = parameter, value = value (use True if parameter is just a flag)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>vw command line parameters as list of strings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.parse_train_params">
<span class="sig-name descname"><span class="pre">parse_train_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.parse_train_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.parse_train_params" title="Link to this definition">#</a></dt>
<dd><p>Parse input hyper-parameters to build vw train commands</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>dict</em>) – key = parameter, value = value (use True if parameter is just a flag)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>vw command line parameters as list of strings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.predict" title="Link to this definition">#</a></dt>
<dd><p>Predict results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input test data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.to_vw_cmd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_vw_cmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.to_vw_cmd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.to_vw_cmd" title="Link to this definition">#</a></dt>
<dd><p>Convert dictionary of parameters to vw command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>dict</em>) – key = parameter, value = value (use True if parameter is just a flag)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>vw command line parameters as list of strings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.to_vw_file">
<span class="sig-name descname"><span class="pre">to_vw_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.to_vw_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.to_vw_file" title="Link to this definition">#</a></dt>
<dd><p>Convert Pandas DataFrame to vw input format file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input DataFrame</p></li>
<li><p><strong>train</strong> (<em>bool</em>) – flag for train mode (or test mode if False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.wide_deep.wide_deep_utils">
<span id="wide-deep"></span><h2>Wide &amp; Deep<a class="headerlink" href="#module-recommenders.models.wide_deep.wide_deep_utils" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.wide_deep.wide_deep_utils.build_feature_columns">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.wide_deep.wide_deep_utils.</span></span><span class="sig-name descname"><span class="pre">build_feature_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_feat_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossed_feat_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_feat_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wide_deep'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/wide_deep/wide_deep_utils.html#build_feature_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.wide_deep.wide_deep_utils.build_feature_columns" title="Link to this definition">#</a></dt>
<dd><p>Build wide and/or deep feature columns for TensorFlow high-level API Estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>users</strong> (<em>iterable</em>) – Distinct user ids.</p></li>
<li><p><strong>items</strong> (<em>iterable</em>) – Distinct item ids.</p></li>
<li><p><strong>user_col</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>item_col</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>item_feat_col</strong> (<em>str</em>) – Item feature column name for ‘deep’ or ‘wide_deep’ model.</p></li>
<li><p><strong>crossed_feat_dim</strong> (<em>int</em>) – Crossed feature dimension for ‘wide’ or ‘wide_deep’ model.</p></li>
<li><p><strong>user_dim</strong> (<em>int</em>) – User embedding dimension for ‘deep’ or ‘wide_deep’ model.</p></li>
<li><p><strong>item_dim</strong> (<em>int</em>) – Item embedding dimension for ‘deep’ or ‘wide_deep’ model.</p></li>
<li><p><strong>item_feat_shape</strong> (<em>int</em><em> or </em><em>an iterable</em><em> of </em><em>integers</em>) – Item feature array shape for ‘deep’ or ‘wide_deep’ model.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Model type, either
‘wide’ for a linear model,
‘deep’ for a deep neural networks, or
‘wide_deep’ for a combination of linear model and neural networks.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>The wide feature columns</p></li>
<li><p>The deep feature columns. If only the wide model is selected, the deep column list is empty and viceversa.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.wide_deep.wide_deep_utils.build_model">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.wide_deep.wide_deep_utils.</span></span><span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wide_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ftrl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dnn_optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Adagrad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dnn_hidden_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dnn_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dnn_batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_every_n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoints_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/wide_deep/wide_deep_utils.html#build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.wide_deep.wide_deep_utils.build_model" title="Link to this definition">#</a></dt>
<dd><p>Build wide-deep model.</p>
<p>To generate wide model, pass wide_columns only.
To generate deep model, pass deep_columns only.
To generate wide_deep model, pass both wide_columns and deep_columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_dir</strong> (<em>str</em>) – Model checkpoint directory.</p></li>
<li><p><strong>wide_columns</strong> (<em>list</em><em> of </em><em>tf.feature_column</em>) – Wide model feature columns.</p></li>
<li><p><strong>deep_columns</strong> (<em>list</em><em> of </em><em>tf.feature_column</em>) – Deep model feature columns.</p></li>
<li><p><strong>linear_optimizer</strong> (<em>str</em><em> or </em><em>tf.train.Optimizer</em>) – Wide model optimizer name or object.</p></li>
<li><p><strong>dnn_optimizer</strong> (<em>str</em><em> or </em><em>tf.train.Optimizer</em>) – Deep model optimizer name or object.</p></li>
<li><p><strong>dnn_hidden_units</strong> (<em>list</em><em> of </em><em>int</em>) – Deep model hidden units. E.g., [10, 10, 10] is three layers of 10 nodes each.</p></li>
<li><p><strong>dnn_dropout</strong> (<em>float</em>) – Deep model’s dropout rate.</p></li>
<li><p><strong>dnn_batch_norm</strong> (<em>bool</em>) – Deep model’s batch normalization flag.</p></li>
<li><p><strong>log_every_n_iter</strong> (<em>int</em>) – Log the training loss for every n steps.</p></li>
<li><p><strong>save_checkpoints_steps</strong> (<em>int</em>) – Model checkpoint frequency.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.estimator.Estimator</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="evaluation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Evaluation module</p>
      </div>
    </a>
    <a class="right-next"
       href="tuning.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hyperparameter tuning module</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.cornac.cornac_utils">Cornac utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.cornac_utils.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.cornac_utils.predict_ranking"><code class="docutils literal notranslate"><span class="pre">predict_ranking()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.bpr.BPR"><code class="docutils literal notranslate"><span class="pre">BPR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.bpr.BPR.__init__"><code class="docutils literal notranslate"><span class="pre">BPR.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.cornac.bpr.BPR.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">BPR.recommend_k_items()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deeprec-utilities">DeepRec utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.base_model">Base model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.__init__"><code class="docutils literal notranslate"><span class="pre">BaseModel.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.eval"><code class="docutils literal notranslate"><span class="pre">BaseModel.eval()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.fit"><code class="docutils literal notranslate"><span class="pre">BaseModel.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.group_labels"><code class="docutils literal notranslate"><span class="pre">BaseModel.group_labels()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.infer"><code class="docutils literal notranslate"><span class="pre">BaseModel.infer()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.load_model"><code class="docutils literal notranslate"><span class="pre">BaseModel.load_model()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.predict"><code class="docutils literal notranslate"><span class="pre">BaseModel.predict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.run_eval"><code class="docutils literal notranslate"><span class="pre">BaseModel.run_eval()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.base_model.BaseModel.train"><code class="docutils literal notranslate"><span class="pre">BaseModel.train()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.sequential_base_model">Sequential base model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.__init__"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.fit"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.predict"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel.predict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.run_eval"><code class="docutils literal notranslate"><span class="pre">SequentialBaseModel.run_eval()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.io.iterator">Iterators</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.BaseIterator"><code class="docutils literal notranslate"><span class="pre">BaseIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.BaseIterator.gen_feed_dict"><code class="docutils literal notranslate"><span class="pre">BaseIterator.gen_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.BaseIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">BaseIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.BaseIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">BaseIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.__init__"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.gen_feed_dict"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator.gen_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">FFMTextIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.__init__"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_feed_dict"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.gen_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_infer_feed_dict"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.gen_infer_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_infer_data_from_file"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.load_infer_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">DKNTextIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator"><code class="docutils literal notranslate"><span class="pre">DKNItem2itemTextIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.__init__"><code class="docutils literal notranslate"><span class="pre">DKNItem2itemTextIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">DKNItem2itemTextIterator.load_data_from_file()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator"><code class="docutils literal notranslate"><span class="pre">NextItNetIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator.__init__"><code class="docutils literal notranslate"><span class="pre">NextItNetIterator.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator"><code class="docutils literal notranslate"><span class="pre">SequentialIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.__init__"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.gen_feed_dict"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.gen_feed_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parse_file"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.parse_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">SequentialIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.DataModel.ImplicitCF">Data processing utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF"><code class="docutils literal notranslate"><span class="pre">ImplicitCF</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.__init__"><code class="docutils literal notranslate"><span class="pre">ImplicitCF.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.create_norm_adj_mat"><code class="docutils literal notranslate"><span class="pre">ImplicitCF.create_norm_adj_mat()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.get_norm_adj_mat"><code class="docutils literal notranslate"><span class="pre">ImplicitCF.get_norm_adj_mat()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.train_loader"><code class="docutils literal notranslate"><span class="pre">ImplicitCF.train_loader()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.deeprec_utils">Utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.HParams"><code class="docutils literal notranslate"><span class="pre">HParams</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.HParams.__init__"><code class="docutils literal notranslate"><span class="pre">HParams.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.HParams.__repr__"><code class="docutils literal notranslate"><span class="pre">HParams.__repr__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.HParams.values"><code class="docutils literal notranslate"><span class="pre">HParams.values()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.cal_metric"><code class="docutils literal notranslate"><span class="pre">cal_metric()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.check_nn_config"><code class="docutils literal notranslate"><span class="pre">check_nn_config()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.check_type"><code class="docutils literal notranslate"><span class="pre">check_type()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.create_hparams"><code class="docutils literal notranslate"><span class="pre">create_hparams()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.dcg_score"><code class="docutils literal notranslate"><span class="pre">dcg_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.download_deeprec_resources"><code class="docutils literal notranslate"><span class="pre">download_deeprec_resources()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.flat_config"><code class="docutils literal notranslate"><span class="pre">flat_config()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.hit_score"><code class="docutils literal notranslate"><span class="pre">hit_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.load_dict"><code class="docutils literal notranslate"><span class="pre">load_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.load_yaml"><code class="docutils literal notranslate"><span class="pre">load_yaml()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.mrr_score"><code class="docutils literal notranslate"><span class="pre">mrr_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.ndcg_score"><code class="docutils literal notranslate"><span class="pre">ndcg_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.deeprec_utils.prepare_hparams"><code class="docutils literal notranslate"><span class="pre">prepare_hparams()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.dkn">DKN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn.DKN"><code class="docutils literal notranslate"><span class="pre">DKN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn.DKN.__init__"><code class="docutils literal notranslate"><span class="pre">DKN.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn.DKN.infer_embedding"><code class="docutils literal notranslate"><span class="pre">DKN.infer_embedding()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn.DKN.run_get_embedding"><code class="docutils literal notranslate"><span class="pre">DKN.run_get_embedding()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.dkn_item2item">DKN item-to-item</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item"><code class="docutils literal notranslate"><span class="pre">DKNItem2Item</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.eval"><code class="docutils literal notranslate"><span class="pre">DKNItem2Item.eval()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.run_eval"><code class="docutils literal notranslate"><span class="pre">DKNItem2Item.run_eval()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.xDeepFM">xDeepFM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.xDeepFM.XDeepFMModel"><code class="docutils literal notranslate"><span class="pre">XDeepFMModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.graphrec.lightgcn">LightGCN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN"><code class="docutils literal notranslate"><span class="pre">LightGCN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.__init__"><code class="docutils literal notranslate"><span class="pre">LightGCN.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.fit"><code class="docutils literal notranslate"><span class="pre">LightGCN.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.infer_embedding"><code class="docutils literal notranslate"><span class="pre">LightGCN.infer_embedding()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.load"><code class="docutils literal notranslate"><span class="pre">LightGCN.load()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">LightGCN.recommend_k_items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.run_eval"><code class="docutils literal notranslate"><span class="pre">LightGCN.run_eval()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.score"><code class="docutils literal notranslate"><span class="pre">LightGCN.score()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.asvd">A2SVD</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.asvd.A2SVDModel"><code class="docutils literal notranslate"><span class="pre">A2SVDModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.caser">Caser</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.caser.CaserModel"><code class="docutils literal notranslate"><span class="pre">CaserModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.caser.CaserModel.__init__"><code class="docutils literal notranslate"><span class="pre">CaserModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gru">GRU</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.nextitnet">NextItNet</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.nextitnet.NextItNetModel"><code class="docutils literal notranslate"><span class="pre">NextItNetModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.rnn_cell_implement">RNN Cells</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell"><code class="docutils literal notranslate"><span class="pre">Time4ALSTMCell</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.call"><code class="docutils literal notranslate"><span class="pre">Time4ALSTMCell.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.output_size"><code class="docutils literal notranslate"><span class="pre">Time4ALSTMCell.output_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.state_size"><code class="docutils literal notranslate"><span class="pre">Time4ALSTMCell.state_size</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell"><code class="docutils literal notranslate"><span class="pre">Time4LSTMCell</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.call"><code class="docutils literal notranslate"><span class="pre">Time4LSTMCell.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.output_size"><code class="docutils literal notranslate"><span class="pre">Time4LSTMCell.output_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.state_size"><code class="docutils literal notranslate"><span class="pre">Time4LSTMCell.state_size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">SUM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.sli_rec">SLIRec</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.deeprec.models.sequential.sli_rec.SLI_RECModel"><code class="docutils literal notranslate"><span class="pre">SLI_RECModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#embdotbias-utilities">EmbDotBias utilities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.lightfm.lightfm_utils">LightFM utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.compare_metric"><code class="docutils literal notranslate"><span class="pre">compare_metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.model_perf_plots"><code class="docutils literal notranslate"><span class="pre">model_perf_plots()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.prepare_all_predictions"><code class="docutils literal notranslate"><span class="pre">prepare_all_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.prepare_test_df"><code class="docutils literal notranslate"><span class="pre">prepare_test_df()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.similar_items"><code class="docutils literal notranslate"><span class="pre">similar_items()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.similar_users"><code class="docutils literal notranslate"><span class="pre">similar_users()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightfm.lightfm_utils.track_model_metrics"><code class="docutils literal notranslate"><span class="pre">track_model_metrics()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.lightgbm.lightgbm_utils">LightGBM utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder"><code class="docutils literal notranslate"><span class="pre">NumEncoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.fit_transform"><code class="docutils literal notranslate"><span class="pre">NumEncoder.fit_transform()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.transform"><code class="docutils literal notranslate"><span class="pre">NumEncoder.transform()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.lightgbm.lightgbm_utils.unpackbits"><code class="docutils literal notranslate"><span class="pre">unpackbits()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.ncf.dataset">NCF</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.DataFile"><code class="docutils literal notranslate"><span class="pre">DataFile</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.DataFile.__init__"><code class="docutils literal notranslate"><span class="pre">DataFile.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.DataFile.load_data"><code class="docutils literal notranslate"><span class="pre">DataFile.load_data()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.Dataset"><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.Dataset.__init__"><code class="docutils literal notranslate"><span class="pre">Dataset.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.Dataset.test_loader"><code class="docutils literal notranslate"><span class="pre">Dataset.test_loader()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.Dataset.train_loader"><code class="docutils literal notranslate"><span class="pre">Dataset.train_loader()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.EmptyFileException"><code class="docutils literal notranslate"><span class="pre">EmptyFileException</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.FileNotSortedException"><code class="docutils literal notranslate"><span class="pre">FileNotSortedException</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.MissingFieldsException"><code class="docutils literal notranslate"><span class="pre">MissingFieldsException</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.MissingUserException"><code class="docutils literal notranslate"><span class="pre">MissingUserException</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.NegativeSampler"><code class="docutils literal notranslate"><span class="pre">NegativeSampler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.NegativeSampler.__init__"><code class="docutils literal notranslate"><span class="pre">NegativeSampler.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.dataset.NegativeSampler.sample"><code class="docutils literal notranslate"><span class="pre">NegativeSampler.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF"><code class="docutils literal notranslate"><span class="pre">NCF</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.__init__"><code class="docutils literal notranslate"><span class="pre">NCF.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.fit"><code class="docutils literal notranslate"><span class="pre">NCF.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.load"><code class="docutils literal notranslate"><span class="pre">NCF.load()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.predict"><code class="docutils literal notranslate"><span class="pre">NCF.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.ncf.ncf_singlenode.NCF.save"><code class="docutils literal notranslate"><span class="pre">NCF.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newsrec-utilities">NewsRec utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Base model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.hparams"><code class="docutils literal notranslate"><span class="pre">BaseModel.hparams</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.train_iterator"><code class="docutils literal notranslate"><span class="pre">BaseModel.train_iterator</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.test_iterator"><code class="docutils literal notranslate"><span class="pre">BaseModel.test_iterator</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.graph"><code class="docutils literal notranslate"><span class="pre">BaseModel.graph</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.seed"><code class="docutils literal notranslate"><span class="pre">BaseModel.seed</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.__init__"><code class="docutils literal notranslate"><span class="pre">BaseModel.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.eval"><code class="docutils literal notranslate"><span class="pre">BaseModel.eval()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.fit"><code class="docutils literal notranslate"><span class="pre">BaseModel.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.group_labels"><code class="docutils literal notranslate"><span class="pre">BaseModel.group_labels()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.run_eval"><code class="docutils literal notranslate"><span class="pre">BaseModel.run_eval()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.base_model.BaseModel.train"><code class="docutils literal notranslate"><span class="pre">BaseModel.train()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Iterators</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator"><code class="docutils literal notranslate"><span class="pre">MINDIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.col_spliter"><code class="docutils literal notranslate"><span class="pre">MINDIterator.col_spliter</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.ID_spliter"><code class="docutils literal notranslate"><span class="pre">MINDIterator.ID_spliter</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.batch_size"><code class="docutils literal notranslate"><span class="pre">MINDIterator.batch_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.title_size"><code class="docutils literal notranslate"><span class="pre">MINDIterator.title_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.his_size"><code class="docutils literal notranslate"><span class="pre">MINDIterator.his_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.npratio"><code class="docutils literal notranslate"><span class="pre">MINDIterator.npratio</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.__init__"><code class="docutils literal notranslate"><span class="pre">MINDIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_behaviors"><code class="docutils literal notranslate"><span class="pre">MINDIterator.init_behaviors()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_news"><code class="docutils literal notranslate"><span class="pre">MINDIterator.init_news()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_dict"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_impression_from_file"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_impression_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_news_from_file"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_news_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_user_from_file"><code class="docutils literal notranslate"><span class="pre">MINDIterator.load_user_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">MINDIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.col_spliter"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.col_spliter</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.ID_spliter"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.ID_spliter</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.batch_size"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.batch_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.title_size"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.title_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.body_size"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.body_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.his_size"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.his_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.npratio"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.npratio</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.__init__"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_behaviors"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.init_behaviors()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_news"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.init_news()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_data_from_file"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_data_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_dict"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_dict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_impression_from_file"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_impression_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_news_from_file"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_news_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_user_from_file"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.load_user_from_file()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.parser_one_line"><code class="docutils literal notranslate"><span class="pre">MINDAllIterator.parser_one_line()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2"><code class="docutils literal notranslate"><span class="pre">AttLayer2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.dim"><code class="docutils literal notranslate"><span class="pre">AttLayer2.dim</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.__init__"><code class="docutils literal notranslate"><span class="pre">AttLayer2.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.build"><code class="docutils literal notranslate"><span class="pre">AttLayer2.build()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.call"><code class="docutils literal notranslate"><span class="pre">AttLayer2.call()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.compute_mask"><code class="docutils literal notranslate"><span class="pre">AttLayer2.compute_mask()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.AttLayer2.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">AttLayer2.compute_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.ComputeMasking"><code class="docutils literal notranslate"><span class="pre">ComputeMasking</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.ComputeMasking.call"><code class="docutils literal notranslate"><span class="pre">ComputeMasking.call()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.ComputeMasking.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">ComputeMasking.compute_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.OverwriteMasking"><code class="docutils literal notranslate"><span class="pre">OverwriteMasking</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.build"><code class="docutils literal notranslate"><span class="pre">OverwriteMasking.build()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.call"><code class="docutils literal notranslate"><span class="pre">OverwriteMasking.call()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">OverwriteMasking.compute_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.PersonalizedAttentivePooling"><code class="docutils literal notranslate"><span class="pre">PersonalizedAttentivePooling()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.dim1"><code class="docutils literal notranslate"><span class="pre">dim1</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.dim2"><code class="docutils literal notranslate"><span class="pre">dim2</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.dim3"><code class="docutils literal notranslate"><span class="pre">dim3</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention"><code class="docutils literal notranslate"><span class="pre">SelfAttention</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.Mask"><code class="docutils literal notranslate"><span class="pre">SelfAttention.Mask()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.__init__"><code class="docutils literal notranslate"><span class="pre">SelfAttention.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.build"><code class="docutils literal notranslate"><span class="pre">SelfAttention.build()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.call"><code class="docutils literal notranslate"><span class="pre">SelfAttention.call()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">SelfAttention.compute_output_shape()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.layers.SelfAttention.get_config"><code class="docutils literal notranslate"><span class="pre">SelfAttention.get_config()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.check_nn_config"><code class="docutils literal notranslate"><span class="pre">check_nn_config()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.check_type"><code class="docutils literal notranslate"><span class="pre">check_type()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.create_hparams"><code class="docutils literal notranslate"><span class="pre">create_hparams()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.get_mind_data_set"><code class="docutils literal notranslate"><span class="pre">get_mind_data_set()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.newsample"><code class="docutils literal notranslate"><span class="pre">newsample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.prepare_hparams"><code class="docutils literal notranslate"><span class="pre">prepare_hparams()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.newsrec_utils.word_tokenize"><code class="docutils literal notranslate"><span class="pre">word_tokenize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.models.lstur">LSTUR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.lstur.LSTURModel"><code class="docutils literal notranslate"><span class="pre">LSTURModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.lstur.LSTURModel.word2vec_embedding"><code class="docutils literal notranslate"><span class="pre">LSTURModel.word2vec_embedding</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.lstur.LSTURModel.hparam"><code class="docutils literal notranslate"><span class="pre">LSTURModel.hparam</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.lstur.LSTURModel.__init__"><code class="docutils literal notranslate"><span class="pre">LSTURModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.models.naml">NAML</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.naml.NAMLModel"><code class="docutils literal notranslate"><span class="pre">NAMLModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.naml.NAMLModel.word2vec_embedding"><code class="docutils literal notranslate"><span class="pre">NAMLModel.word2vec_embedding</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.naml.NAMLModel.hparam"><code class="docutils literal notranslate"><span class="pre">NAMLModel.hparam</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.naml.NAMLModel.__init__"><code class="docutils literal notranslate"><span class="pre">NAMLModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.models.npa">NPA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.npa.NPAModel"><code class="docutils literal notranslate"><span class="pre">NPAModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.npa.NPAModel.word2vec_embedding"><code class="docutils literal notranslate"><span class="pre">NPAModel.word2vec_embedding</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.npa.NPAModel.hparam"><code class="docutils literal notranslate"><span class="pre">NPAModel.hparam</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.npa.NPAModel.__init__"><code class="docutils literal notranslate"><span class="pre">NPAModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.models.nrms">NRMS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.nrms.NRMSModel"><code class="docutils literal notranslate"><span class="pre">NRMSModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.nrms.NRMSModel.word2vec_embedding"><code class="docutils literal notranslate"><span class="pre">NRMSModel.word2vec_embedding</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.nrms.NRMSModel.hparam"><code class="docutils literal notranslate"><span class="pre">NRMSModel.hparam</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.newsrec.models.nrms.NRMSModel.__init__"><code class="docutils literal notranslate"><span class="pre">NRMSModel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.rbm.rbm">RBM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM"><code class="docutils literal notranslate"><span class="pre">RBM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.__init__"><code class="docutils literal notranslate"><span class="pre">RBM.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.batch_training"><code class="docutils literal notranslate"><span class="pre">RBM.batch_training()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.binomial_sampling"><code class="docutils literal notranslate"><span class="pre">RBM.binomial_sampling()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.data_pipeline"><code class="docutils literal notranslate"><span class="pre">RBM.data_pipeline()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.eval_out"><code class="docutils literal notranslate"><span class="pre">RBM.eval_out()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.fit"><code class="docutils literal notranslate"><span class="pre">RBM.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.free_energy"><code class="docutils literal notranslate"><span class="pre">RBM.free_energy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.generate_graph"><code class="docutils literal notranslate"><span class="pre">RBM.generate_graph()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.gibbs_protocol"><code class="docutils literal notranslate"><span class="pre">RBM.gibbs_protocol()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.gibbs_sampling"><code class="docutils literal notranslate"><span class="pre">RBM.gibbs_sampling()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.init_gpu"><code class="docutils literal notranslate"><span class="pre">RBM.init_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.init_metrics"><code class="docutils literal notranslate"><span class="pre">RBM.init_metrics()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.init_parameters"><code class="docutils literal notranslate"><span class="pre">RBM.init_parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.init_training_session"><code class="docutils literal notranslate"><span class="pre">RBM.init_training_session()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.load"><code class="docutils literal notranslate"><span class="pre">RBM.load()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.losses"><code class="docutils literal notranslate"><span class="pre">RBM.losses()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.multinomial_distribution"><code class="docutils literal notranslate"><span class="pre">RBM.multinomial_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.multinomial_sampling"><code class="docutils literal notranslate"><span class="pre">RBM.multinomial_sampling()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.placeholder"><code class="docutils literal notranslate"><span class="pre">RBM.placeholder()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.predict"><code class="docutils literal notranslate"><span class="pre">RBM.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">RBM.recommend_k_items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.sample_hidden_units"><code class="docutils literal notranslate"><span class="pre">RBM.sample_hidden_units()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.sample_visible_units"><code class="docutils literal notranslate"><span class="pre">RBM.sample_visible_units()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.rbm.rbm.RBM.save"><code class="docutils literal notranslate"><span class="pre">RBM.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sar.sar_singlenode">SAR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode"><code class="docutils literal notranslate"><span class="pre">SARSingleNode</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.__init__"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_affinity_matrix"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.compute_affinity_matrix()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_cooccurrence_matrix"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.compute_cooccurrence_matrix()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_time_decay"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.compute_time_decay()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.fit"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_item_based_topk"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.get_item_based_topk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_popularity_based_topk"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.get_popularity_based_topk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_topk_most_similar_users"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.get_topk_most_similar_users()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.predict"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.recommend_k_items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.score"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.set_index"><code class="docutils literal notranslate"><span class="pre">SARSingleNode.set_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sasrec.model">SASRec</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.Encoder"><code class="docutils literal notranslate"><span class="pre">Encoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.Encoder.__init__"><code class="docutils literal notranslate"><span class="pre">Encoder.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.Encoder.call"><code class="docutils literal notranslate"><span class="pre">Encoder.call()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.EncoderLayer"><code class="docutils literal notranslate"><span class="pre">EncoderLayer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.EncoderLayer.__init__"><code class="docutils literal notranslate"><span class="pre">EncoderLayer.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.EncoderLayer.call"><code class="docutils literal notranslate"><span class="pre">EncoderLayer.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.EncoderLayer.call_"><code class="docutils literal notranslate"><span class="pre">EncoderLayer.call_()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.LayerNormalization"><code class="docutils literal notranslate"><span class="pre">LayerNormalization</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.LayerNormalization.__init__"><code class="docutils literal notranslate"><span class="pre">LayerNormalization.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.LayerNormalization.call"><code class="docutils literal notranslate"><span class="pre">LayerNormalization.call()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.MultiHeadAttention"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.MultiHeadAttention.__init__"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.MultiHeadAttention.call"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention.call()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.PointWiseFeedForward"><code class="docutils literal notranslate"><span class="pre">PointWiseFeedForward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.PointWiseFeedForward.__init__"><code class="docutils literal notranslate"><span class="pre">PointWiseFeedForward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.PointWiseFeedForward.call"><code class="docutils literal notranslate"><span class="pre">PointWiseFeedForward.call()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC"><code class="docutils literal notranslate"><span class="pre">SASREC</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.__init__"><code class="docutils literal notranslate"><span class="pre">SASREC.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.call"><code class="docutils literal notranslate"><span class="pre">SASREC.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.create_combined_dataset"><code class="docutils literal notranslate"><span class="pre">SASREC.create_combined_dataset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.embedding"><code class="docutils literal notranslate"><span class="pre">SASREC.embedding()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.evaluate"><code class="docutils literal notranslate"><span class="pre">SASREC.evaluate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.evaluate_valid"><code class="docutils literal notranslate"><span class="pre">SASREC.evaluate_valid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.loss_function"><code class="docutils literal notranslate"><span class="pre">SASREC.loss_function()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.predict"><code class="docutils literal notranslate"><span class="pre">SASREC.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.model.SASREC.train"><code class="docutils literal notranslate"><span class="pre">SASREC.train()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler"><code class="docutils literal notranslate"><span class="pre">WarpSampler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.User"><code class="docutils literal notranslate"><span class="pre">WarpSampler.User</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.usernum"><code class="docutils literal notranslate"><span class="pre">WarpSampler.usernum</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.itemnum"><code class="docutils literal notranslate"><span class="pre">WarpSampler.itemnum</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.batch_size"><code class="docutils literal notranslate"><span class="pre">WarpSampler.batch_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.maxlen"><code class="docutils literal notranslate"><span class="pre">WarpSampler.maxlen</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.n_workers"><code class="docutils literal notranslate"><span class="pre">WarpSampler.n_workers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.WarpSampler.__init__"><code class="docutils literal notranslate"><span class="pre">WarpSampler.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.sampler.sample_function"><code class="docutils literal notranslate"><span class="pre">sample_function()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.usernum"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.usernum</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.itemnum"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.itemnum</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.User"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.User</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.Items"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.Items</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.user_train"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.user_train</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.user_valid"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.user_valid</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.user_test"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.user_test</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.col_sep"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.col_sep</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.util.SASRecDataSet.filename"><code class="docutils literal notranslate"><span class="pre">SASRecDataSet.filename</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sasrec.ssept">SSE-PT</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT"><code class="docutils literal notranslate"><span class="pre">SSEPT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT.__init__"><code class="docutils literal notranslate"><span class="pre">SSEPT.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT.call"><code class="docutils literal notranslate"><span class="pre">SSEPT.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT.loss_function"><code class="docutils literal notranslate"><span class="pre">SSEPT.loss_function()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.sasrec.ssept.SSEPT.predict"><code class="docutils literal notranslate"><span class="pre">SSEPT.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.surprise.surprise_utils">Surprise utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.surprise.surprise_utils.compute_ranking_predictions"><code class="docutils literal notranslate"><span class="pre">compute_ranking_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.surprise.surprise_utils.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.surprise.surprise_utils.surprise_trainset_to_df"><code class="docutils literal notranslate"><span class="pre">surprise_trainset_to_df()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.tfidf.tfidf_utils">TF-IDF utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.clean_dataframe"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.clean_dataframe()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.fit"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_stop_words"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.get_stop_words()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_tokens"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.get_tokens()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_top_k_recommendations"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.get_top_k_recommendations()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.recommend_top_k_items"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.recommend_top_k_items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.tokenize_text"><code class="docutils literal notranslate"><span class="pre">TfidfRecommender.tokenize_text()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.vae.standard_vae">Standard VAE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.__init__"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.get_data"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.get_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_batch_end"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_train_begin"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.LossHistory"><code class="docutils literal notranslate"><span class="pre">LossHistory</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.LossHistory.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">LossHistory.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.LossHistory.on_train_begin"><code class="docutils literal notranslate"><span class="pre">LossHistory.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics"><code class="docutils literal notranslate"><span class="pre">Metrics</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.__init__"><code class="docutils literal notranslate"><span class="pre">Metrics.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.get_data"><code class="docutils literal notranslate"><span class="pre">Metrics.get_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">Metrics.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.on_train_begin"><code class="docutils literal notranslate"><span class="pre">Metrics.on_train_begin()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.Metrics.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">Metrics.recommend_k_items()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE"><code class="docutils literal notranslate"><span class="pre">StandardVAE</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.__init__"><code class="docutils literal notranslate"><span class="pre">StandardVAE.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.display_metrics"><code class="docutils literal notranslate"><span class="pre">StandardVAE.display_metrics()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.fit"><code class="docutils literal notranslate"><span class="pre">StandardVAE.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.get_optimal_beta"><code class="docutils literal notranslate"><span class="pre">StandardVAE.get_optimal_beta()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.ndcg_per_epoch"><code class="docutils literal notranslate"><span class="pre">StandardVAE.ndcg_per_epoch()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.nn_batch_generator"><code class="docutils literal notranslate"><span class="pre">StandardVAE.nn_batch_generator()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.standard_vae.StandardVAE.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">StandardVAE.recommend_k_items()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.vae.multinomial_vae">Multinomial VAE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.__init__"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.get_data"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.get_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_batch_end"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_train_begin"><code class="docutils literal notranslate"><span class="pre">AnnealingCallback.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.LossHistory"><code class="docutils literal notranslate"><span class="pre">LossHistory</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.LossHistory.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">LossHistory.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.LossHistory.on_train_begin"><code class="docutils literal notranslate"><span class="pre">LossHistory.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics"><code class="docutils literal notranslate"><span class="pre">Metrics</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.__init__"><code class="docutils literal notranslate"><span class="pre">Metrics.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.get_data"><code class="docutils literal notranslate"><span class="pre">Metrics.get_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">Metrics.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.on_train_begin"><code class="docutils literal notranslate"><span class="pre">Metrics.on_train_begin()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Metrics.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">Metrics.recommend_k_items()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE"><code class="docutils literal notranslate"><span class="pre">Mult_VAE</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.__init__"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.display_metrics"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.display_metrics()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.fit"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.get_optimal_beta"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.get_optimal_beta()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.ndcg_per_epoch"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.ndcg_per_epoch()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.nn_batch_generator"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.nn_batch_generator()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.recommend_k_items"><code class="docutils literal notranslate"><span class="pre">Mult_VAE.recommend_k_items()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.vowpal_wabbit.vw">Vowpal Wabbit utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW"><code class="docutils literal notranslate"><span class="pre">VW</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.fit"><code class="docutils literal notranslate"><span class="pre">VW.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.parse_test_params"><code class="docutils literal notranslate"><span class="pre">VW.parse_test_params()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.parse_train_params"><code class="docutils literal notranslate"><span class="pre">VW.parse_train_params()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.predict"><code class="docutils literal notranslate"><span class="pre">VW.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.to_vw_cmd"><code class="docutils literal notranslate"><span class="pre">VW.to_vw_cmd()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.vowpal_wabbit.vw.VW.to_vw_file"><code class="docutils literal notranslate"><span class="pre">VW.to_vw_file()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.wide_deep.wide_deep_utils">Wide &amp; Deep</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.wide_deep.wide_deep_utils.build_feature_columns"><code class="docutils literal notranslate"><span class="pre">build_feature_columns()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommenders.models.wide_deep.wide_deep_utils.build_model"><code class="docutils literal notranslate"><span class="pre">build_model()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Recommenders contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2018-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>